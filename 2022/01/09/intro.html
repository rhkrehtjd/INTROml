<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>2022/01/09/SUN | INTROml</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="2022/01/09/SUN" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://rhkrehtjd.github.io/INTROml/2022/01/09/intro.html" />
<meta property="og:url" content="https://rhkrehtjd.github.io/INTROml/2022/01/09/intro.html" />
<meta property="og:site_name" content="INTROml" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-09T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2022/01/09/SUN" />
<script type="application/ld+json">
{"url":"https://rhkrehtjd.github.io/INTROml/2022/01/09/intro.html","@type":"BlogPosting","headline":"2022/01/09/SUN","dateModified":"2022-01-09T00:00:00-06:00","datePublished":"2022-01-09T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rhkrehtjd.github.io/INTROml/2022/01/09/intro.html"},"description":"An easy to use blogging platform with support for Jupyter Notebooks.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/INTROml/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://rhkrehtjd.github.io/INTROml/feed.xml" title="INTROml" /><link rel="shortcut icon" type="image/x-icon" href="/INTROml/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/INTROml/">INTROml</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/INTROml/about/">About Me</a><a class="page-link" href="/INTROml/search/">Search</a><a class="page-link" href="/INTROml/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">2022/01/09/SUN</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-09T00:00:00-06:00" itemprop="datePublished">
        Jan 9, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/rhkrehtjd/INTROml/tree/master/_notebooks/2022-01-09-intro.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/INTROml/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/rhkrehtjd/INTROml/master?filepath=_notebooks%2F2022-01-09-intro.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/INTROml/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/rhkrehtjd/INTROml/blob/master/_notebooks/2022-01-09-intro.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/INTROml/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frhkrehtjd%2FINTROml%2Fblob%2Fmaster%2F_notebooks%2F2022-01-09-intro.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/INTROml/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-01-09-intro.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;학습 데이터 레이블 값 비율&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;테스트 데이터 레이블 값 비율&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>학습 데이터 레이블 값 비율
0    99.827451
1     0.172549
Name: Class, dtype: float64
테스트 데이터 레이블 값 비율
0    99.826785
1     0.173215
Name: Class, dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>학습데이터 레이블과 테스트 레이블을 살펴본 결 과 잘 분할 됐음. 이제 로지스틱 회귀와 LightGBM 기반의 모델이 데이터 가공을 수행하면서 예측 성능이 어떻게 변하는지 살펴보자</p>
<p>먼저 로지스틱 회귀를 이용해 신용 카드 사기 여부를 예측해보자</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">lr_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="n">lr_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">lr_pred</span> <span class="o">=</span> <span class="n">lr_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">lr_pred_proba</span> <span class="o">=</span> <span class="n">lr_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># 3장에서 사용한 get_clf_eval() 함수를 이용하여 평가 수행. </span>
<span class="n">get_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lr_pred</span><span class="p">,</span> <span class="n">lr_pred_proba</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이번에는 LightGBM을 이용한 모델을 만들어보자</p>
<p>(앞으로 수행할 예제 코드에서 반복적으로 모델을 변경해 학습/예측/평가할 것이므로 이를 위한 별도의 함수를 생성해보자)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_model_train_eval</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ftr_train</span><span class="p">,</span> <span class="n">tgt_train</span><span class="p">)</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">ftr_test</span><span class="p">)</span>
    <span class="n">pred_proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">ftr_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">get_clf_eval</span><span class="p">(</span><span class="n">tgt_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">pred_proba</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>먼저, 본 데이터 세트는 극도로 불균형한 레이블 값 분포를 지녔음 $\to$ LightGBMClassifier객체 생성 시 boost_from_average=False로 파라미터를 설정해야한다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>LightGBM으로 모델을 학습한 뒤 별도의 테스트 데이터 세트에서 예측 평가를 수행해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMClassifier</span>

<span class="n">lgbm_clf</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_leaves</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">boost_from_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>오차 행렬
[[85290     5]
 [   36   112]]
정확도: 0.9995, 정밀도: 0.9573, 재현율: 0.7568,    F1: 0.8453, AUC:0.9790
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>재현율과 ROC-AUC가 회귀보다 높은 수치 기록.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>왜곡된 분포도를 가지는 데이터를 재가공한 뒤 모델을 다시 테스트해보자. </li>
<li>대부분의 선형 모델은 중요 feature들의 값이 정규 분포 형태를 유지하는 것을 선호.</li>
<li>Amount feature는 중요 feature일 가능성이 높음.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">card_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./creditcard.csv&#39;</span><span class="p">)</span>
<span class="n">card_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">card_df</span><span class="p">[</span><span class="s1">&#39;Amount&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:xlabel=&#39;Amount&#39;, ylabel=&#39;Density&#39;&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="c1"># Amount를 정규분포 형태로 변환 후 로지스틱 회귀 및 LightGBM 수행. </span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_train_test_dataset</span><span class="p">(</span><span class="n">card_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### 로지스틱 회귀 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">lr_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### LightGBM 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">lgbm_clf</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_leaves</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">boost_from_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>성능이 크게 개선되지 X $\to$ 이번에는 StandardScaler가 아니라 로그 변환을 수행해보자.</li>
<li>로그 변환은 데이터 분포도가 심하게 왜곡되어 있을 경우 적용하는 중요 기법 중 하나.(원래 값을 log 값으로 변환해 원래 큰 값을 상대적으로 작은 값으로 변환하기 때문에 데이터 분포도의 왜곡을 상당수준 개선해준다.)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_preprocessed_df</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># 넘파이의 log1p( )를 이용하여 Amount를 로그 변환 </span>
    <span class="n">amount_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Amount&#39;</span><span class="p">])</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Amount_Scaled&#39;</span><span class="p">,</span> <span class="n">amount_n</span><span class="p">)</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;Amount&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_copy</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 Amount feature를 log 변환한 후 다시 로지스틱 회귀와 LightGBM 모델을 적용한 후 예측 성능을 확인해보자</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># log1p 와 expm1 설명 </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">print</span><span class="p">(</span><span class="mf">1e-1000</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e-1000</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e-1000</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="mf">1e-1000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>True
-inf
0.0
0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">var_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">var_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var_1</span><span class="p">,</span> <span class="n">var_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4.61512051684126 100.00000000000003
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_train_test_dataset</span><span class="p">(</span><span class="n">card_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### 로지스틱 회귀 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### LightGBM 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>### 로지스틱 회귀 예측 성능 ###
오차 행렬
[[85283    12]
 [   59    89]]
정확도: 0.9992, 정밀도: 0.8812, 재현율: 0.6014,    F1: 0.7149, AUC:0.9727
### LightGBM 예측 성능 ###
오차 행렬
[[85290     5]
 [   35   113]]
정확도: 0.9995, 정밀도: 0.9576, 재현율: 0.7635,    F1: 0.8496, AUC:0.9796
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>두 모델 모두 정밀도, 재현율, ROC-AUC에서 약간씩 성능이 개선되었음을 알 수 있음</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="&#51060;&#49345;&#52824;-&#45936;&#51060;&#53552;-:Outlier-??-&#51204;&#52404;-&#45936;&#51060;&#53552;&#51032;-&#54056;&#53556;&#50640;&#49436;-&#48279;&#50612;&#45212;-&#51060;&#49345;-&#44050;&#51012;-&#44032;&#51652;-&#45936;&#51060;&#53552;.-IQR&#48169;&#49885;&#51060;-&#51080;&#51020;.-IQR&#51008;-&#49324;&#48516;&#50948;-&#44050;&#51032;-&#54200;&#52264;&#47484;-&#51060;&#50857;&#54616;&#45716;-&#44592;&#48277;&#51004;&#47196;&#49436;-&#55124;&#55176;-&#48149;&#49828;&#54540;&#46991;&#51004;&#47196;-&#49884;&#44033;&#54868;-&#54624;-&#49688;-&#51080;&#45796;."><code>&#51060;&#49345;&#52824; &#45936;&#51060;&#53552; :Outlier ??</code> &#51204;&#52404; &#45936;&#51060;&#53552;&#51032; &#54056;&#53556;&#50640;&#49436; &#48279;&#50612;&#45212; &#51060;&#49345; &#44050;&#51012; &#44032;&#51652; &#45936;&#51060;&#53552;. IQR&#48169;&#49885;&#51060; &#51080;&#51020;. IQR&#51008; &#49324;&#48516;&#50948; &#44050;&#51032; &#54200;&#52264;&#47484; &#51060;&#50857;&#54616;&#45716; &#44592;&#48277;&#51004;&#47196;&#49436; &#55124;&#55176; &#48149;&#49828;&#54540;&#46991;&#51004;&#47196; &#49884;&#44033;&#54868; &#54624; &#49688; &#51080;&#45796;.<a class="anchor-link" href="#&#51060;&#49345;&#52824;-&#45936;&#51060;&#53552;-:Outlier-??-&#51204;&#52404;-&#45936;&#51060;&#53552;&#51032;-&#54056;&#53556;&#50640;&#49436;-&#48279;&#50612;&#45212;-&#51060;&#49345;-&#44050;&#51012;-&#44032;&#51652;-&#45936;&#51060;&#53552;.-IQR&#48169;&#49885;&#51060;-&#51080;&#51020;.-IQR&#51008;-&#49324;&#48516;&#50948;-&#44050;&#51032;-&#54200;&#52264;&#47484;-&#51060;&#50857;&#54616;&#45716;-&#44592;&#48277;&#51004;&#47196;&#49436;-&#55124;&#55176;-&#48149;&#49828;&#54540;&#46991;&#51004;&#47196;-&#49884;&#44033;&#54868;-&#54624;-&#49688;-&#51080;&#45796;."> </a></h3><p>먼저 사분위란 전체 데이터를 값이 높은 순으로 정렬하고 이를 25%씩 구간 분할하는 것을 지칭. 가령 100명의 시험 성적이 0점부터 100점까지 있다면 이를 100등부터 1등까지 성적순으로 정렬한 뒤 1/4구간으로 나누는 것. <strong><em><code>여기서 25%~75% 범위를 IQR이라고 한다</code></em></strong>. IQR에 보통은 1.5를 공해서 75%지점에 더해주고 25%지점에서 빼준 뒤 그 범위를 넘어가면 outlier로 간주!. 이를 시각화한 도표가 boxplot이다.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>먼저 어떤 feature의 이상치 데이터를 검출할 것인지 선택. </li>
<li>매우 많은 feature가 있을 경우 상관성이 높은 feature들을 위주로 이상치를 검출하자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">card_df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>양의 상관관계가 높을수록 색이 진한 파란색. 음의 상관관계가 높을수록 색이 진한 빨간색.</p>
</li>
<li><p>이중 결정 레이블에 속하는 Class feature와 음의 상관관계가 가장 높은 feature는 V14와 V17, 이중 V14에서 outlier를 제거해보자</p>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">get_outlier</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
    <span class="c1"># fraud에 해당하는 column 데이터만 추출, 1/4 분위와 3/4 분위 지점을 np.percentile로 구함. </span>
    <span class="n">fraud</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">column</span><span class="p">]</span>
    <span class="n">quantile_25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">fraud</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">quantile_75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">fraud</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    
    <span class="c1"># IQR을 구하고, IQR에 1.5를 곱하여 최대값과 최소값 지점 구함. </span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">quantile_75</span> <span class="o">-</span> <span class="n">quantile_25</span>
    <span class="n">iqr_weight</span> <span class="o">=</span> <span class="n">iqr</span> <span class="o">*</span> <span class="n">weight</span>
    <span class="n">lowest_val</span> <span class="o">=</span> <span class="n">quantile_25</span> <span class="o">-</span> <span class="n">iqr_weight</span>
    <span class="n">highest_val</span> <span class="o">=</span> <span class="n">quantile_75</span> <span class="o">+</span> <span class="n">iqr_weight</span>
    
    <span class="c1"># 최대값 보다 크거나, 최소값 보다 작은 값을 아웃라이어로 설정하고 DataFrame index 반환. </span>
    <span class="n">outlier_index</span> <span class="o">=</span> <span class="n">fraud</span><span class="p">[(</span><span class="n">fraud</span> <span class="o">&lt;</span> <span class="n">lowest_val</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">fraud</span> <span class="o">&gt;</span> <span class="n">highest_val</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
    
    <span class="k">return</span> <span class="n">outlier_index</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outlier_index</span> <span class="o">=</span> <span class="n">get_outlier</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">card_df</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;V14&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;이상치 데이터 인덱스:&#39;</span><span class="p">,</span> <span class="n">outlier_index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>이상치 데이터 인덱스: Int64Index([8296, 8615, 9035, 9252], dtype=&#39;int64&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이를 삭제하는 로직을 추가</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_preprocessed_df</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">amount_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Amount&#39;</span><span class="p">])</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Amount_Scaled&#39;</span><span class="p">,</span> <span class="n">amount_n</span><span class="p">)</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;Amount&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 이상치 데이터 삭제하는 로직 추가</span>
    <span class="n">outlier_index</span> <span class="o">=</span> <span class="n">get_outlier</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_copy</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;V14&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outlier_index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_copy</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_train_test_dataset</span><span class="p">(</span><span class="n">card_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### 로지스틱 회귀 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### LightGBM 예측 성능 ###&#39;</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>### 로지스틱 회귀 예측 성능 ###
오차 행렬
[[85281    14]
 [   48    98]]
정확도: 0.9993, 정밀도: 0.8750, 재현율: 0.6712,    F1: 0.7597, AUC:0.9743
### LightGBM 예측 성능 ###
오차 행렬
[[85290     5]
 [   25   121]]
정확도: 0.9996, 정밀도: 0.9603, 재현율: 0.8288,    F1: 0.8897, AUC:0.9780
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>outlier 제거한 뒤 로지스틱 회귀와 LightGBM 모두 예측 성능이 크게 향상됐음을 알 수 있다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>SMOTE 기법으로 오버 샘플링을 적용한 뒤 로지스틱 회구와 LightGBM 모델의 예측 성능을 평가해보자</li>
<li>SMOTE를 적용할 땐, 반드시 학습 데이터 세트만 오버 샘플링 해야함</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>

<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_train_over</span><span class="p">,</span> <span class="n">y_train_over</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_sample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SMOTE 적용 전 학습용 피처/레이블 데이터 세트: &#39;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SMOTE 적용 후 학습용 피처/레이블 데이터 세트: &#39;</span><span class="p">,</span> <span class="n">X_train_over</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train_over</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SMOTE 적용 후 레이블 값 분포: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train_over</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SMOTE 적용 전 학습용 피처/레이블 데이터 세트:  (199362, 29) (199362,)
SMOTE 적용 후 학습용 피처/레이블 데이터 세트:  (398040, 29) (398040,)
SMOTE 적용 후 레이블 값 분포: 
 0    199020
1    199020
Name: Class, dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="c1"># ftr_train과 tgt_train 인자값이 SMOTE 증식된 X_train_over와 y_train_over로 변경됨에 유의</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train_over</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span> <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train_over</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>오차 행렬
[[82937  2358]
 [   11   135]]
정확도: 0.9723, 정밀도: 0.0542, 재현율: 0.9247,    F1: 0.1023, AUC:0.9737
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>재현울은 크게 증가하나 정밀도가 급격히 저하</li>
<li>이 정도로 저조한 정밀도는 현실 업무에 적용할 수 없음</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lgbm_clf</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_leaves</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">boost_from_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">get_model_train_eval</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">ftr_train</span><span class="o">=</span><span class="n">X_train_over</span><span class="p">,</span> <span class="n">ftr_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span>
                  <span class="n">tgt_train</span><span class="o">=</span><span class="n">y_train_over</span><span class="p">,</span> <span class="n">tgt_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>오차 행렬
[[85283    12]
 [   22   124]]
정확도: 0.9996, 정밀도: 0.9118, 재현율: 0.8493,    F1: 0.8794, AUC:0.9814
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>재현율은 높아졌으나 정밀도는 좀 낮아짐.</li>
<li>SMOTE를 적용하면 재현율은 높아지나 정밀도는 낮아지는 것이 일반적임.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="&#49828;&#53468;&#53433;-&#50521;&#49345;&#48660;"><code>&#49828;&#53468;&#53433; &#50521;&#49345;&#48660;</code><a class="anchor-link" href="#&#49828;&#53468;&#53433;-&#50521;&#49345;&#48660;"> </a></h3><p>스태킹은 개별적인 여러 알고리즘을 서로 결합해 예측 결과를 도출한다는 점에서 배깅,부스팅과 일맥상통. 허나 가장 큰 차이점은 개별 알고리즘으로 예측한 데이터를 기반으로 다시 마지막 특정 알고리즘으로 재예측시도함. 즉 개별 알고리즘의 예측 결과 데이터 세트를 최종적인 메타 데이터 세트로 만들어 별도의 ML 알고리즘으로 최종학습을 수행하고 테스트 데이터를 기반으로 다시 최종 예측을 수행하는 방식. 이렇게 개별 모델의 예측된 데이터 세트를 다시 기반으로 하여 학습하고 예측하는 방식을 메타 모델이라고 한다. 따라서 스태킹 모델은 두 종류의 모델 필요. 첫번째는 기반 모델, 두번째는 이 개별 기반 모델의 예측 데이터를 학습 데이터로 만들어서 학습하는 최종 메타 모델. 스태킹 모델의 핵심은 여러 개별 모델의 예측 데이터를 각각 스태킹 형태로 결합해, 즉 잘 쌓아서, 최종 메타 모델의 학습용 feature데이터 세트와 테스트용 feature 데이터 세트를 만드는 것이다. 이를 도식화 한 248p참고</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>기본 스태킹 모델을 위스콘신 암 데이터 세트에 적용해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">cancer_data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="n">X_data</span> <span class="o">=</span> <span class="n">cancer_data</span><span class="o">.</span><span class="n">data</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="n">cancer_data</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span> <span class="p">,</span> <span class="n">y_train</span> <span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_data</span> <span class="p">,</span> <span class="n">y_label</span> <span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span> <span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>스태킹에 사용될 머신러닝 알고리즘 클래스를 생성하자. </li>
<li>개별 모델은 KNN, 랜덤 포레스트, 결정 트리, 에이다 부스트이며 이들 모델의 예측 결과를 합한 데이터 세트로 학습,예측 수행하는 최종 모델은 로지스틱 회귀이다. </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn_clf</span>  <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dt_clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">ada_clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 최종 Stacking 모델을 위한 Classifier생성. </span>
<span class="n">lr_final</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>개별 모델들을 학습시키자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">rf_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">dt_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">ada_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(n_estimators=100)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>개별 모델의 예측 데이터 세트를 반환하고 각 모델의 예측 정확도를 살펴보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn_pred</span> <span class="o">=</span> <span class="n">knn_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rf_pred</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">dt_pred</span> <span class="o">=</span> <span class="n">dt_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">ada_pred</span> <span class="o">=</span> <span class="n">ada_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KNN 정확도: </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">knn_pred</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;랜덤 포레스트 정확도: </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_pred</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;결정 트리 정확도: </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dt_pred</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;에이다부스트 정확도: </span><span class="si">{0:.4f}</span><span class="s1"> :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">ada_pred</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>KNN 정확도: 0.9211
랜덤 포레스트 정확도: 0.9649
결정 트리 정확도: 0.9123
에이다부스트 정확도: 0.9561 :
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>개별 알고리즘으로부터 예측된 예측값을 칼럼 레벨로 옆으로 붙여서 feature값으로 만들어, 최종 메타 모델인 로지스틱 회귀에서 학습 데이터로 다시 사용하자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">knn_pred</span><span class="p">,</span> <span class="n">rf_pred</span><span class="p">,</span> <span class="n">dt_pred</span><span class="p">,</span> <span class="n">ada_pred</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># transpose를 이용해 행과 열의 위치 교환. 컬럼 레벨로 각 알고리즘의 예측 결과를 피처로 만듦. </span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(4, 114)
(114, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">lr_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;최종 메타 모델의 예측 정확도: </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span> <span class="p">,</span> <span class="n">final</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>최종 메타 모델의 예측 정확도: 0.9737
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>개별 모델 정확도보다 스태킹으로 재구성해 최종 메타 모델에서 학습하고 예측한 결과가 더 높음.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="CV-&#49464;&#53944;-&#44592;&#48152;&#51032;-&#49828;&#53468;&#53433;"><code>CV &#49464;&#53944; &#44592;&#48152;&#51032; &#49828;&#53468;&#53433;</code><a class="anchor-link" href="#CV-&#49464;&#53944;-&#44592;&#48152;&#51032;-&#49828;&#53468;&#53433;"> </a></h3><p>과적합을 개선하기 위해 최종 메타 모델을 위한 데이터 세트를 만들 때 교차 검증을 기반으로 예측된 결과 데이터 세트를 이용한다. 앞에서 마지막에 메타 모델인 로지스틱 회귀 모델을 기반으로 최종 학습할 때 레이블 데이터 세트로 학습데이터가 아닌 테스트용 레이블 데이터 세트를 기반으로 학습했기에 과적합 문제가 발생할 수 있다. CV세트 기반의 스태킹은 이에 대한 개선을 위해 개별 모델들이 각각 교차 검증으로 메타모델을 위한 학습용 스태킹 데이터 생성과 예측을 위한 테스트용 스태킹 데이터를 생성한 뒤 이를 기반으로 메타 모델이 학습과 예측을 수행한다. 자세한 건 284p참고하자</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="c1"># 개별 기반 모델에서 최종 메타 모델이 사용할 학습 및 테스트용 데이터를 생성하기 위한 함수. </span>
<span class="k">def</span> <span class="nf">get_stacking_base_datasets</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train_n</span><span class="p">,</span> <span class="n">y_train_n</span><span class="p">,</span> <span class="n">X_test_n</span><span class="p">,</span> <span class="n">n_folds</span> <span class="p">):</span>
    <span class="c1"># 지정된 n_folds값으로 KFold 생성.</span>
    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_folds</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1">#추후에 메타 모델이 사용할 학습 데이터 반환을 위한 넘파이 배열 초기화 </span>
    <span class="n">train_fold_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_train_n</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span><span class="mi">1</span> <span class="p">))</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_test_n</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n_folds</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="p">,</span> <span class="s1">&#39; model 시작 &#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">folder_counter</span> <span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">valid_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_train_n</span><span class="p">)):</span>
        <span class="c1">#입력된 학습 데이터에서 기반 모델이 학습/예측할 폴드 데이터 셋 추출 </span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> 폴드 세트: &#39;</span><span class="p">,</span><span class="n">folder_counter</span><span class="p">,</span><span class="s1">&#39; 시작 &#39;</span><span class="p">)</span>
        <span class="n">X_tr</span> <span class="o">=</span> <span class="n">X_train_n</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span> 
        <span class="n">y_tr</span> <span class="o">=</span> <span class="n">y_train_n</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span> 
        <span class="n">X_te</span> <span class="o">=</span> <span class="n">X_train_n</span><span class="p">[</span><span class="n">valid_index</span><span class="p">]</span>  
        
        <span class="c1">#폴드 세트 내부에서 다시 만들어진 학습 데이터로 기반 모델의 학습 수행.</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span> <span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
        
        <span class="c1">#폴드 세트 내부에서 다시 만들어진 검증 데이터로 기반 모델 예측 후 데이터 저장.</span>
        <span class="n">train_fold_pred</span><span class="p">[</span><span class="n">valid_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#입력된 원본 테스트 데이터를 폴드 세트내 학습된 기반 모델에서 예측 후 데이터 저장. </span>
        <span class="n">test_pred</span><span class="p">[:,</span> <span class="n">folder_counter</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_n</span><span class="p">)</span>
            
    <span class="c1"># 폴드 세트 내에서 원본 테스트 데이터를 예측한 데이터를 평균하여 테스트 데이터로 생성 </span>
    <span class="n">test_pred_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">test_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>    
    
    <span class="c1">#train_fold_pred는 최종 메타 모델이 사용하는 학습 데이터, test_pred_mean은 테스트 데이터</span>
    <span class="k">return</span> <span class="n">train_fold_pred</span> <span class="p">,</span> <span class="n">test_pred_mean</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn_train</span><span class="p">,</span> <span class="n">knn_test</span> <span class="o">=</span> <span class="n">get_stacking_base_datasets</span><span class="p">(</span><span class="n">knn_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">rf_train</span><span class="p">,</span> <span class="n">rf_test</span> <span class="o">=</span> <span class="n">get_stacking_base_datasets</span><span class="p">(</span><span class="n">rf_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">dt_train</span><span class="p">,</span> <span class="n">dt_test</span> <span class="o">=</span> <span class="n">get_stacking_base_datasets</span><span class="p">(</span><span class="n">dt_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span>  <span class="mi">7</span><span class="p">)</span>    
<span class="n">ada_train</span><span class="p">,</span> <span class="n">ada_test</span> <span class="o">=</span> <span class="n">get_stacking_base_datasets</span><span class="p">(</span><span class="n">ada_clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>KNeighborsClassifier  model 시작 
	 폴드 세트:  0  시작 
	 폴드 세트:  1  시작 
	 폴드 세트:  2  시작 
	 폴드 세트:  3  시작 
	 폴드 세트:  4  시작 
	 폴드 세트:  5  시작 
	 폴드 세트:  6  시작 
RandomForestClassifier  model 시작 
	 폴드 세트:  0  시작 
	 폴드 세트:  1  시작 
	 폴드 세트:  2  시작 
	 폴드 세트:  3  시작 
	 폴드 세트:  4  시작 
	 폴드 세트:  5  시작 
	 폴드 세트:  6  시작 
DecisionTreeClassifier  model 시작 
	 폴드 세트:  0  시작 
	 폴드 세트:  1  시작 
	 폴드 세트:  2  시작 
	 폴드 세트:  3  시작 
	 폴드 세트:  4  시작 
	 폴드 세트:  5  시작 
	 폴드 세트:  6  시작 
AdaBoostClassifier  model 시작 
	 폴드 세트:  0  시작 
	 폴드 세트:  1  시작 
	 폴드 세트:  2  시작 
	 폴드 세트:  3  시작 
	 폴드 세트:  4  시작 
	 폴드 세트:  5  시작 
	 폴드 세트:  6  시작 
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Stack_final_X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">knn_train</span><span class="p">,</span> <span class="n">rf_train</span><span class="p">,</span> <span class="n">dt_train</span><span class="p">,</span> <span class="n">ada_train</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Stack_final_X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">knn_test</span><span class="p">,</span> <span class="n">rf_test</span><span class="p">,</span> <span class="n">dt_test</span><span class="p">,</span> <span class="n">ada_test</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;원본 학습 피처 데이터 Shape:&#39;</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;원본 테스트 피처 Shape:&#39;</span><span class="p">,</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;스태킹 학습 피처 데이터 Shape:&#39;</span><span class="p">,</span> <span class="n">Stack_final_X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
      <span class="s1">&#39;스태킹 테스트 피처 데이터 Shape:&#39;</span><span class="p">,</span><span class="n">Stack_final_X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>원본 학습 피처 데이터 Shape: (455, 30) 원본 테스트 피처 Shape: (114, 30)
스태킹 학습 피처 데이터 Shape: (455, 4) 스태킹 테스트 피처 데이터 Shape: (114, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Stack_final_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">stack_final</span> <span class="o">=</span> <span class="n">lr_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Stack_final_X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;최종 메타 모델의 예측 정확도: </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">stack_final</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>최종 메타 모델의 예측 정확도: 0.9737
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/INTROml/2022/01/09/intro.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/INTROml/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/INTROml/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/INTROml/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/rhkrehtjd" target="_blank" title="rhkrehtjd"><svg class="svg-icon grey"><use xlink:href="/INTROml/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
