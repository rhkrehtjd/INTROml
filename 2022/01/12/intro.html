<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>2022/01/12/WED | INTROml</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="2022/01/12/WED" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://rhkrehtjd.github.io/INTROml/2022/01/12/intro.html" />
<meta property="og:url" content="https://rhkrehtjd.github.io/INTROml/2022/01/12/intro.html" />
<meta property="og:site_name" content="INTROml" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-12T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2022/01/12/WED" />
<script type="application/ld+json">
{"url":"https://rhkrehtjd.github.io/INTROml/2022/01/12/intro.html","@type":"BlogPosting","headline":"2022/01/12/WED","dateModified":"2022-01-12T00:00:00-06:00","datePublished":"2022-01-12T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rhkrehtjd.github.io/INTROml/2022/01/12/intro.html"},"description":"An easy to use blogging platform with support for Jupyter Notebooks.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/INTROml/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://rhkrehtjd.github.io/INTROml/feed.xml" title="INTROml" /><link rel="shortcut icon" type="image/x-icon" href="/INTROml/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/INTROml/">INTROml</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/INTROml/about/">About Me</a><a class="page-link" href="/INTROml/search/">Search</a><a class="page-link" href="/INTROml/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">2022/01/12/WED</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-12T00:00:00-06:00" itemprop="datePublished">
        Jan 12, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      15 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/rhkrehtjd/INTROml/tree/master/_notebooks/2022-01-12-intro.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/INTROml/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/rhkrehtjd/INTROml/master?filepath=_notebooks%2F2022-01-12-intro.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/INTROml/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/rhkrehtjd/INTROml/blob/master/_notebooks/2022-01-12-intro.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/INTROml/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frhkrehtjd%2FINTROml%2Fblob%2Fmaster%2F_notebooks%2F2022-01-12-intro.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/INTROml/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-01-12-intro.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="&#47196;&#51648;&#49828;&#54001;-&#54924;&#44480;"><strong><em><code>&#47196;&#51648;&#49828;&#54001; &#54924;&#44480;</code></em></strong><a class="anchor-link" href="#&#47196;&#51648;&#49828;&#54001;-&#54924;&#44480;"> </a></h3><p>로지스틱 회귀는 선형 회귀 방식을 분류에 적용한 알고리즘이다. 회귀가 선형인지 비선형인가는 독립 변수가 아닌 가중치 변수가 선형인지 아닌지를 따른다. 로지스틱 회귀가 선형 회귀와 다른 점은 학습을 통해 선형 함수의 회귀 최적선을 찾는 것이 아니라 시그모이드(sigmoid) 함수 최적선을 찾고 이 시그모이드 함수의 반환 값을 확률로 간주해 확률에 따라 분류를 결정한다는 것이다. 많은 자연, 사회 현상에서 특정 변수의 확률 값은 선형이 아니라 시그모이드 함수와 같이 S자 커브 형태를 가진다. 시그모이드 함수 :$y=\frac{1}{1+e^(-x)}$ 시그모이드 함수는 $x$값이 아무리 음,양으로 커지거나 작아져도 $y$값은 항상 0과 1사이 값을 반환한다. $x$ 값이 커지면 1에 근사하며 $x$ 값이 작아지면 0에 근사한다. 지금까지는 부동산 가격과 같은 연속형 값을 구하는 데 회귀를 사용했다. 이번에는 약간 다르게 가령 종양의 크기에 따라 악성 종양인지 그렇지 않은지 1,0을 이용해 예측해보자. 로지스틱 회귀는 선형 회귀 방식을 기반으로 하되 시그모이드 함수를 이용해 분류를 수행하는 회귀이다.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1ca3205da30&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXQAAAD4CAYAAAD8Zh1EAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAgkklEQVR4nO3de3zWdf3/8cdr184bY4ON44bjjIDIYeI5NRXx/E2toDJKi2+WZl+1skwtv99vWdnXtK+VeEgtw8xMqVDUNM0QBETAAYNxkI3TxgY7b9fp/ftj09++COxiu8bnuq4977fbblzX5/rs2vMD25P3Pqe3OecQEZH4l+R1ABERiQ4VuohIglChi4gkCBW6iEiCUKGLiCSIZK++cH5+visuLvbqy4uIxKVVq1btc84VHOo1zwq9uLiYlStXevXlRUTikpm9f7jXtMtFRCRBqNBFRBKECl1EJEGo0EVEEoQKXUQkQXRZ6Gb2qJlVmdl7h3ndzOx+Mys3s7VmNj36MUVEpCuRjNAfA2Yf4fULgbEdH/OBX/U8loiIHK0uz0N3zr1hZsVHWOVy4AnXfh/eZWaWa2ZDnXO7oxVSRCQWOOdoC4Zp8YdoDYZo8YdoC4bbPwKdHgdD+INhAqEw/mAYf8gRCIUJdCw79/jBnFiUG/V80biwaDhQ0el5ZceyjxS6mc2nfRTPiBEjovClRUQiEwo7DjT72d8c4ECznwPNAepaAtS3BmhoDVLfEqCxLUhDW5DG1iBNbUGa/CGa2oI0+0O0+IO0BEKEozCFxOD+6TFb6BFzzi0AFgCUlJRoZg0R6bFmf5BdB1rZU9fKnvpW9ta3Ut3Q1v7R2EZNYxs1TX7qWgIcaT6fzFQf2WnJZKcnt/+ZlkxeVipZqT4y05LJTPGRmeojPdVHerKPjFQf6SlJpCf7SE/xkZacRFpKEqk+H6nJSaQlJ5GSnESqL4nU5CRSfEaKL4nkJMPMeuXvIhqFvhMo6vS8sGOZiEiPhcOO3fWtbN/XxLZ9Teyobaaitpkdtc3sOtDC/ubARz6nX1oyBf3SyM9OY9zgfgzMTmVAVhoDMlPIy0olNzOV3IwU+mekkJORQr/0ZFJ88X/SXzQKfRFwvZk9BZwM1Gn/uYgcLeccVQ1trN9Vz8Y9DWza28Dmqga2VDXREgh9uF5qchJFeRkUDchkalEuw3IzGJabztD+GQzJSWdwTjoZqT4Pt8Q7XRa6mS0EzgbyzawSuBNIAXDO/RpYDFwElAPNwBd7K6yIJI79TX5WV+zn3Yo61lQcoHRXHfsa/R++PrR/OmMGZTNn5gBGF2QzKj+L4vwshuSkk5TUO7ss4l0kZ7nM7eJ1B3wtaolEJCFV1bfy1tYalm2tYcX2/ZRXNQKQZDB2UD/OHj+IScNymDg0hwlDcuifmeJx4vjj2e1zRSSxtQVDvL2tltfLqnl9UzWbOwq8X3oyJcfl8Ylpw5lxXB4nDO9PVpqqKBr0tygiUdPYFuTvG/byUuleXt9UTWNbkFRfEjNHDuCqGYWcNjqficNy8GmXSa9QoYtIj7QFQ7y2sZrn393JqxuraAuGyc9O49ITh3LuhMGcNmYgmamqmmNBf8si0i0b99SzcPkOnl+ziwPNAfKz05hzUhEXTxlGyXF5OnDpARW6iEQsEAqzeN1uHl+6nXd2HCDVl8SsSYO5ckYhZ47JJzkBzuWOZyp0EelSfWuAJ5ft4LGl29hb38bI/Cy+d/HxXDm9kLysVK/jSQcVuogc1v4mP4+8uY3H39pOQ2uQM8bkc/cVUzhrXIF2qcQgFbqIfERDa4BH3tzGw//cRpM/yOxJQ/jaOWOYPLy/19HkCFToIvKhYCjMwrd3cO8rm6lt8jN70hBumjWOcYP7eR1NIqBCFxEA3ty8jx/8pZTNVY2cMmoA37nw+F65xav0HhW6SB9X1dDKf/11A4vW7GLEgEwevHoGsyYO7rVbvErvUaGL9FHOOZ5ZVcldf11PWyDMjeeO5bqzR5Oe0jfvVJgIVOgifdDe+la+8+w6Xt1YxcziAfzoyhMYXZDtdSzpIRW6SB/zUukevvWntbQGQtxxyUS+cFqxTkFMECp0kT6iNRDiR4s38Phb7zNpWA73z52mUXmCUaGL9AE7D7Rw3e9Wsbayji+dMZJvzh5PWrL2lScaFbpIgvtX+T6u//07BEOOBVfPYNakIV5Hkl6iQhdJYL9b9j53LiplVH4WD149g1HaxZLQVOgiCSgUdvz33zbw6L+28fEJg7h/7jSyNStQwtO/sEiCaQ2E+MZT7/Ji6R6uOX0kt118vGYI6iNU6CIJpL41wPwnVrJsay13XDKRa84Y6XUkOYZU6CIJorbJz9WPLKdsTwP3zZnK5VOHex1JjjEVukgC2NfYxmcfWs72miYemlfCOeMHeR1JPKBCF4lzVQ2tfOah5VTub+bRL5zE6WPyvY4kHlGhi8Sx2iY/n31oObsOtPDYF2dyyqiBXkcSD2lGV5E4Vd8a4POPLmdHbTOPzDtJZS4qdJF41OIPcc1vVlC2p4Fff24Gp45WmYt2uYjEnWAozA0LV7Nqx34e+Mx0zpmgA6DSTiN0kTjinOP250t5ZcNefnDZJC46YajXkSSGqNBF4sgDr5Wz8O0dfPXs0Xz+1GKv40iMiajQzWy2mZWZWbmZ3XqI10eY2WtmttrM1prZRdGPKtK3LV63m3te2sS/TR3GNy8Y73UciUFdFrqZ+YAHgAuBicBcM5t40GrfA552zk0D5gC/jHZQkb5sXWUdNz39LtNH5HL3lVM0gbMcUiQj9JlAuXNuq3PODzwFXH7QOg7I6XjcH9gVvYgifVtVfStfemIFA7PSePDqEk3iLIcVSaEPByo6Pa/sWNbZ94HPmVklsBi44VBvZGbzzWylma2srq7uRlyRvsUfDPPVJ9+hviXIw/NKKOiX5nUkiWHROig6F3jMOVcIXAT81sw+8t7OuQXOuRLnXElBQUGUvrRI4vrh4g2sfH8/P75qCscPzen6E6RPi6TQdwJFnZ4Xdizr7FrgaQDn3FtAOqAbSoj0wJ9XV/LY0u186YyRXHbiMK/jSByIpNBXAGPNbKSZpdJ+0HPRQevsAM4FMLPjaS907VMR6abyqga+++x7nDxyALdeOMHrOBInuix051wQuB5YAmyg/WyWUjO7y8wu61jtZuDLZrYGWAh8wTnneiu0SCJrDYT42pOryUz1cf/caST7dLmIRCaiS/+dc4tpP9jZedkdnR6vB06PbjSRvukHfymlbG8Dj18zk8E56V7HkTii//pFYsjf1u5m4dsVXHf2aM4apxMH5Oio0EVixO66Fr7753VMLcrlpvPHeR1H4pAKXSQGhMOOm59eQyAU5uefnkqK9ptLN+i7RiQGPPLmNpZuqeHOSydSnJ/ldRyJUyp0EY9t3tvAT5eUMWviYD5VUtT1J4gchgpdxEPBUJib/7iG7PRkfnjFCbrplvSIZiwS8dCDb2xlbWUdD3xmOvnZuk+L9IxG6CIeKdvTwM9f2cTFU4Zy8RTNPCQ9p0IX8UAo7PjWn9bSLz2Fuy6b5HUcSRAqdBEPPL50O2sqDnDnpRMZqF0tEiUqdJFjrHJ/M/e8VMbZ4wt0F0WJKhW6yDHknON7z70HwH/922Sd1SJRpUIXOYb+tm43/yir5uZZ4ynMy/Q6jiQYFbrIMdLQGuCuv6xn0rAc5p16nNdxJAHpPHSRY+TelzdT3djGgs+X6B7n0iv0XSVyDJTuquOxpdv4zMwRTC3K9TqOJCgVukgvc85xx/Ol5GWm8q0LNJ2c9B4Vukgv+/Pqnax6fz/fvnAC/TNTvI4jCUyFLtKLGloD/HDxRqYW5XLV9EKv40iC00FRkV50/983U9PUxiPzSkhK0jnn0rs0QhfpJeVVjfzmX9v5dEkRJ+pAqBwDKnSRXvLDxRvISPFxywXjvY4ifYQKXaQXvL6pmlc3VnHDuWN0n3M5ZlToIlEWDIX5z7+u57iBmcw7rdjrONKHqNBFouz3b++gvKqR7150PGnJPq/jSB+iQheJovrWAPe+vIlTRg1g1sTBXseRPkaFLhJFv3xtC/ubA3zv4om6Na4ccyp0kSip3N/Mo//axhXThjN5eH+v40gfpEIXiZJ7lpRhoNMUxTMqdJEoWFdZx3Pv7uJLZ45kWG6G13Gkj1Khi/SQc44fvbCBAVmpfOWs0V7HkT4sokI3s9lmVmZm5WZ262HW+ZSZrTezUjP7fXRjisSuNzbvY+mWGm74+Bj6petuiuKdLm/OZWY+4AHgfKASWGFmi5xz6zutMxb4DnC6c26/mQ3qrcAisSQcdtz9wkaKBmTw2ZM1rZx4K5IR+kyg3Dm31TnnB54CLj9onS8DDzjn9gM456qiG1MkNj2/Zicbdtdzy6zxpCZrD6Z4K5LvwOFARafnlR3LOhsHjDOzf5nZMjObfag3MrP5ZrbSzFZWV1d3L7FIjGgLhvjZS5uYPDyHS6cM8zqOSNQOiiYDY4GzgbnAQ2aWe/BKzrkFzrkS51xJQUFBlL60iDcWLt9B5f4Wvj17gu51LjEhkkLfCRR1el7YsayzSmCRcy7gnNsGbKK94EUSUmNbkF+8Ws5powdyxph8r+OIAJEV+gpgrJmNNLNUYA6w6KB1nqN9dI6Z5dO+C2Zr9GKKxJZH39xGTZOfb14wXpf4S8zostCdc0HgemAJsAF42jlXamZ3mdllHastAWrMbD3wGvBN51xNb4UW8VJtk58Fb2zlgkmDmTYiz+s4Ih+KaE5R59xiYPFBy+7o9NgBN3V8iCS0X/2jnGZ/kFtm6RJ/iS06z0rkKOyua+Hxt97nE9MKGTu4n9dxRP4PFbrIUfjFq+U45/jGeTrmL7FHhS4Soe37mnh6RQVzZ46gaECm13FEPkKFLhKhn7+yiWSfcf05Y7yOInJIKnSRCJTtaeD5NbuYd1oxg3LSvY4jckgqdJEI3PvyJrJTk/nKx3R7XIldKnSRLqyrrOPF0j1ce+ZI8rJSvY4jclgqdJEu3PNSGbmZKVx7xkivo4gckQpd5AhWbK/l9U3VfOWs0Zq8QmKeCl3kMJxz3LOkjPzsNOadWux1HJEuqdBFDmPplhqWb6vl+nNGk5Hq8zqOSJdU6CKH4JzjnpfKGNY/nbknj/A6jkhEVOgih/BaWRWrdxzg+o+PJS1Zo3OJDyp0kYOEw46fvbSJEQMy+WRJoddxRCKmQhc5yJLSPZTuqufr544lxacfEYkf+m4V6SQUdtz7yiZGF2TxiWkHz4UuEttU6CKd/HXtLjbtbeQ/zh+HTxM/S5xRoYt0CIbC3PvyJiYM6cdFk4d6HUfkqKnQRTo8+85Ottc0c/Os8SRpdC5xSIUuArQFQ9z3982cWNif844f5HUckW5RoYsAf1hRwc4DLdw8azxmGp1LfFKhS5/X4g/xi1fLmVk8gDPH5nsdR6TbVOjS5z3x1naqG9q45QKNziW+qdClT2toDfDr17fwsXEFzBw5wOs4Ij2iQpc+7ZE3t7G/OcDN54/zOopIj6nQpc/a3+Tn4X9uY/akIZxYlOt1HJEeU6FLn/Xr17fQ5A9y0yyNziUxqNClT9pb38pjS7fzianDGTe4n9dxRKJChS590v1/30wo7PjGeRqdS+JQoUufs31fE39YUcGcmUWMGJjpdRyRqFGhS5/zPy9vIsWXxNc/PtbrKCJRFVGhm9lsMyszs3Izu/UI611pZs7MSqIXUSR6SnfVsWjNLq45o5hBOelexxGJqi4L3cx8wAPAhcBEYK6ZTTzEev2AG4Hl0Q4pEi0/XVJG/4wU5n9stNdRRKIukhH6TKDcObfVOecHngIuP8R6/wn8GGiNYj6RqFm2tYZ/lFXz1bNH0z8jxes4IlEXSaEPByo6Pa/sWPYhM5sOFDnn/nakNzKz+Wa20sxWVldXH3VYke5yznH3CxsZkpPOvNOKvY4j0it6fFDUzJKA/wFu7mpd59wC51yJc66koKCgp19aJGIvvLeHdysOcNP540hP8XkdR6RXRFLoO4GiTs8LO5Z9oB8wGfiHmW0HTgEW6cCoxIpAKMxPl5QxbnA2V84o9DqOSK+JpNBXAGPNbKSZpQJzgEUfvOicq3PO5Tvnip1zxcAy4DLn3MpeSSxylJ5aUcG2fU1864IJmvhZElqXhe6cCwLXA0uADcDTzrlSM7vLzC7r7YAiPdHYFuS+VzYxs3gA52pqOUlwyZGs5JxbDCw+aNkdh1n37J7HEomOB1/fwr5GPw99foImr5CEpytFJWHtrmvhoX9u5dIThzFtRJ7XcUR6nQpdEtbPXtpEOAzfumC811FEjgkVuiSk0l11/OmdSr54ejFFA3QDLukbVOiScJxz3PWX9eRmpPDVc8Z4HUfkmFGhS8JZUrqX5dtquWnWeF3iL32KCl0SSlswxA8Xb2Dc4GzmnlTU9SeIJBAVuiSUx/61nR21zdx+yUSSffr2lr5F3/GSMKoaWvnFq+V8fMIgzhyrewVJ36NCl4Rx9wsb8QfD3H7JR27XL9InqNAlIax6v5Zn39nJl84cycj8LK/jiHhChS5xLxR23PF8KUNy0vmaTlOUPkyFLnFv4ds7KN1Vz20XH09WWkS3JxJJSCp0iWvVDW385MWNnDpqIJdMGep1HBFPqdAlrv1o8QZaAiH+898m626K0uep0CVuvbWlhmdX72T+x0YxZlC213FEPKdCl7jUFgxx+/PvUZiXwfXnjPU6jkhM0BEkiUu/+scWyqsa+c0XTiIjVZM+i4BG6BKHNu9t4IHXyrl86jDOmaBp5UQ+oEKXuBIOO779p7VkpSXrilCRg6jQJa78dtn7vLPjALdfPJH87DSv44jEFBW6xI0dNc3c/cJGzhybzxXTh3sdRyTmqNAlLoTDjlueWUNykvHjK6fonHORQ1ChS1x44q3tvL2tltsvmciw3Ayv44jEJBW6xLyt1Y3c/eJGzh5fwCdLCr2OIxKzVOgS0wKhMP/xh3dJT/Fx9xXa1SJyJLqwSGLa/X/fzJrKOn752ekM6Z/udRyRmKYRusSsldtreeC1cq6aUchFJ+hOiiJdUaFLTKprDnDjU+9SmJfJ9y+b5HUckbigXS4Sc5xzfPOZNVQ1tPLMV04jW5NWiEREI3SJOY8v3c5L6/fy7dkTOLEo1+s4InFDhS4xZU3FAX64eCPnThjEtWeM9DqOSFyJqNDNbLaZlZlZuZndeojXbzKz9Wa21sz+bmbHRT+qJLqaxjau+90qCvqlcc8nT9QpiiJHqctCNzMf8ABwITARmGtmB9/mbjVQ4pybAjwD/CTaQSWxBUNhbli4mpomPw9ePYO8rFSvI4nEnUhG6DOBcufcVuecH3gKuLzzCs6515xzzR1PlwG6nE+Oyk+WlLF0Sw3//YkTmDy8v9dxROJSJIU+HKjo9LyyY9nhXAu8cKgXzGy+ma00s5XV1dWRp5SE9syqSha8sZWrTzmOq2ZoLCDSXVE9KGpmnwNKgJ8e6nXn3ALnXIlzrqSgoCCaX1ri1IrttXzn2bWcPmYgd1yqCStEeiKSE3x3AkWdnhd2LPs/zOw84DbgLOdcW3TiSSKrqG3m33+7iqK8TH75mRmk+HTSlUhPRPITtAIYa2YjzSwVmAMs6ryCmU0DHgQuc85VRT+mJJraJj/zHn2bUNjx8LwS+memeB1JJO51WejOuSBwPbAE2AA87ZwrNbO7zOyyjtV+CmQDfzSzd81s0WHeToQWf4hrH1/BzgMtPDKvhFEF2V5HEkkIEV1T7ZxbDCw+aNkdnR6fF+VckqACoTA3LHyHdysO8KvPzqCkeIDXkUQShnZayjETCjtufnoNr2yo4q7LJzN78hCvI4kkFBW6HBPhsOO7z65j0ZpdfHv2BK4+RRcTi0SbCl16XTjsuHNRKX9YWcENHx/DdWeP9jqSSELSfUmlV4XDjtueW8fCtyuY/7FR3HT+OK8jiSQsFbr0mlDYceuf1vLHVZV87ZzR3DJrvG64JdKLVOjSK1oDIW58ajVLSvdy47lj+cZ5Y1XmIr1MhS5R19Aa4MtPrGTZ1lruvHQiXzxd9zUXORZU6BJVlfubufaxlWypbuS+OVO5fOqR7uMmItGkQpeoWb1jP19+YhVtwRCPfXEmZ4zN9zqSSJ+iQpeoeGZVJbf9eR2Dc9J5av4pjBmky/lFjjUVuvRIWzDEXX9Zz5PLd3Da6IH872emM0CzDYl4QoUu3fZ+TRNfX7iaNZV1/PtZo/jmrPEk6xa4Ip5RoUu3PLd6J9977j2SDH79uenMnjzU60gifZ4KXY5KbZOf259/j7+t3c1JxXn8fM40hudmeB1LRFChS4Scc7z43h5uf/496loC3DJrHF85a7R2sYjEEBW6dKmitpk7F5Xy6sYqJg3L4XdfOpkJQ3K8jiUiB1Ghy2G1+EMseGMrv3q9nCQzvnfx8XzhtGKNykVilApdPiIcdjy/Zic/ebGM3XWtXDh5CLdfMpFh2lcuEtNU6PIh5xyvbKjiZy+VsXFPA5OH5/DzT0/l5FEDvY4mIhFQoQvhsGNJ6R4e+Ec57+2sZ2R+Fr+YO42LTxhKUpLukCgSL1TofViLP8Szqyt55M1tbK1uYmR+Fj+5agpXTBuu/eQicUiF3gdt39fEwrd38IeVFRxoDjB5eA6/mDuNi04Yik8jcpG4pULvI5r9QZaU7uGPKytZuqUGX5Jx/vGDueaMkZxUnKfJJ0QSgAo9gbUFQ7y5eR9/W7ubF0v30OwPUZiXwc3nj+NTJxUxOCfd64giEkUq9ART3xrg9bJqXl6/l9fKqmhoDdI/I4VLpwzjyhmFlByXpwOdIglKhR7nAqEwayvrWFq+j9c3VbO64gChsGNgVioXTh7ChScM5fTR+aQm6yCnSKJToceZprYgayvrWPV+LSu272fl9lqa/CEAphT257qzRnPOhAKmFuXpAKdIH6NCj2GNbUHK9tRTuque93bWsbayjk17Gwi79tfHDc7miumFnDp6IKeMGqiJJUT6OBW6x5xz1Db52V7TxNbqJsqrG9lS1cjGPQ1U7m/5cL28zBSmFOYya9IQphb1Z/qIPHIzVeAi8v+p0HtZOOyoafKzt76V3XWt7DrQws4DLVTub2ZHbTPv1zTT0Br8cP0UnzEyP4upRbl8uqSICUNzmDQsh6H903VqoYgcUUSFbmazgfsAH/Cwc+7ug15PA54AZgA1wKedc9ujGzU2hMKOhtYAdS0BDjQH2N/s50BzgJomP7VNbdQ0+tnX2EZ1QxtVDe1/Bj/YR9IhNTmJwrwMivIymVqUS/HALEbmt3+MGJCpqzRFpFu6LHQz8wEPAOcDlcAKM1vknFvfabVrgf3OuTFmNgf4MfDp3gjcFeccgZDDHwrjD7Z/tAVDtAXDtAXCtAZDtAZCtPhDtAbDtPiDNPtDNPvblzX5gzS3hWj0B2lqC9LYGqSxLUhDa5D61gCNbUGcO/TX9iUZA7JSGZiVSkG/NMYM6segnDSG5KQzOCedIf3TGZ6bQX52qkbbIhJ1kYzQZwLlzrmtAGb2FHA50LnQLwe+3/H4GeB/zcycO1z1dd8fVuzgwTe2Egw5gqEwgbAjEAoTDLn2Ag+Fu/3eSQaZqclkpfnISk0mOz2Z7LRkirIyyUlPoV96MjkZKfTv+MjLTCE3M4XczPYSz0lP0TneIuKZSAp9OFDR6XklcPLh1nHOBc2sDhgI7Ou8kpnNB+YDjBgxoluBB2SlcfzQHFKSjGRfEim+JFJ8RnJSEqnJSaT6rP3P5CRSfUmkpfhI63ienuwjLSWJ9BQf6ck+MlKTyEhNJiPFR2Zq+3oaOYtIvDqmB0WdcwuABQAlJSXdGr2fP3Ew508cHNVcIiKJIJKjbzuBok7PCzuWHXIdM0sG+tN+cFRERI6RSAp9BTDWzEaaWSowB1h00DqLgHkdj68CXu2N/eciInJ4Xe5y6dgnfj2whPbTFh91zpWa2V3ASufcIuAR4LdmVg7U0l76IiJyDEW0D905txhYfNCyOzo9bgU+Gd1oIiJyNHQFi4hIglChi4gkCBW6iEiCUKGLiCQI8+rsQjOrBt7v5qfnc9BVqHEskbYFEmt7tC2xqa9vy3HOuYJDveBZofeEma10zpV4nSMaEmlbILG2R9sSm7Qth6ddLiIiCUKFLiKSIOK10Bd4HSCKEmlbILG2R9sSm7QthxGX+9BFROSj4nWELiIiB1Ghi4gkiLgudDO7wcw2mlmpmf3E6zw9ZWY3m5kzs3yvs3SXmf20499krZn92cxyvc50tMxstpmVmVm5md3qdZ7uMrMiM3vNzNZ3/Izc6HWmnjIzn5mtNrO/ep2lp8ws18ye6fh52WBmp/b0PeO20M3sHNrnMj3ROTcJuMfjSD1iZkXALGCH11l66GVgsnNuCrAJ+I7HeY5Kp0nRLwQmAnPNbKK3qbotCNzsnJsInAJ8LY635QM3Ahu8DhEl9wEvOucmACcShe2K20IHrgPuds61ATjnqjzO01P3At8C4vootXPuJedcsOPpMtpnuIonH06K7pzzAx9Mih53nHO7nXPvdDxuoL0whnubqvvMrBC4GHjY6yw9ZWb9gY/RPpcEzjm/c+5AT983ngt9HHCmmS03s9fN7CSvA3WXmV0O7HTOrfE6S5RdA7zgdYijdKhJ0eO2BD9gZsXANGC5x1F64ue0D3rCHueIhpFANfCbjl1ID5tZVk/f9JhOEn20zOwVYMghXrqN9uwDaP9V8iTgaTMbFatT33WxLd+lfXdLXDjStjjnnu9Y5zbaf+V/8lhmk48ys2zgT8A3nHP1XufpDjO7BKhyzq0ys7M9jhMNycB04Abn3HIzuw+4Fbi9p28as5xz5x3uNTO7Dni2o8DfNrMw7Te6qT5W+Y7G4bbFzE6g/X/rNWYG7bso3jGzmc65PccwYsSO9O8CYGZfAC4Bzo3V/2CPIJJJ0eOGmaXQXuZPOuee9TpPD5wOXGZmFwHpQI6Z/c459zmPc3VXJVDpnPvgN6ZnaC/0HonnXS7PAecAmNk4IJU4vAObc26dc26Qc67YOVdM+z/09Fgt866Y2Wzafy2+zDnX7HWebohkUvS4YO0jhEeADc65//E6T084577jnCvs+BmZQ/tE9PFa5nT8fFeY2fiORecC63v6vjE9Qu/Co8CjZvYe4AfmxeFoMBH9L5AGvNzxG8cy59xXvI0UucNNiu5xrO46HbgaWGdm73Ys+27HHMHivRuAJzsGDluBL/b0DXXpv4hIgojnXS4iItKJCl1EJEGo0EVEEoQKXUQkQajQRUQShApdRCRBqNBFRBLE/wMN64WGVPdFWAAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 위스콘신 유방암 데이터 세트를 이용해 로지스틱 회귀로 암 여부를 판단해 보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>선형 회귀 계열의 로지스틱 회귀는 데이터의 정규 분포도에 따라 예측 성능 영향을 받을 수 있으므로 데이터에 먼저 정규 분포 형태의 <code>표준 스케일링</code>을 적용하자. </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># StandardScaler( )로 평균이 0, 분산 1로 데이터 분포도 변환</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">X_train</span> <span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span> <span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">,</span> <span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>

<span class="c1"># 로지스틱 회귀를 이용하여 학습 및 예측 수행. </span>
<span class="n">lr_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lr_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">lr_preds</span> <span class="o">=</span> <span class="n">lr_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># accuracy와 roc_auc 측정</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;accuracy: </span><span class="si">{:0.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lr_preds</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;roc_auc: </span><span class="si">{:0.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span> <span class="p">,</span> <span class="n">lr_preds</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>accuracy: 0.977
roc_auc: 0.972
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>사이킷런 LogisticRegression 클래스의 주요 하이퍼 파라미터로 penalty와 C가 있다. penalty는 규제의 유형을 설정하며 default는 l2이다. C는 규제 강도를 조절하는 alpha값의 역수이다. 즉 C 값이 작을 수록 규제 강도가 크다.</li>
<li>GridSearchCV를 이용해 위스콘신 데이터 세트에서 이 하이퍼 파라미터를 최적화 해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;penalty&#39;</span><span class="p">:[</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">],</span>
        <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>

<span class="n">grid_clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span> <span class="p">)</span>
<span class="n">grid_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">,</span> <span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;최적 하이퍼 파라미터:</span><span class="si">{0}</span><span class="s1">, 최적 평균 정확도:</span><span class="si">{1:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_clf</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> 
                                                  <span class="n">grid_clf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>최적 하이퍼 파라미터:{&#39;C&#39;: 1, &#39;penalty&#39;: &#39;l2&#39;}, 최적 평균 정확도:0.975
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>로지스틱 회귀는 가볍고 빠르지만 이진 분류 예측 성능도 뛰어나다. 이 때문에 로지스틱 회귀를 이진 분류의 기본 모델로 사용하는 경우가 많다. 또한 로지스틱 회귀는 희소한 데이터 세트 분류에도 뛰어난 성능을 보여서 텍스트 분류에서도 자주 사용된다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>지금까지 선형 회귀에 대해 알아봤다. 선형 회귀는 회귀 계수의 관계를 모두 선형으로 가정하는 방식이다. 일반적으로 선형 회귀는 회귀 계수를 선형으로 결합하는 회귀 함수를 구해 여기에 독립 변수를 입력해 결괏값을 예측하는 것이다. 비선형 회귀 역시 비선형 회귀 함수를 통해 결괏값을 예측한다. 다만 비선형 회귀는 회귀 계수의 결합이 비선형일 뿐이다. 재차 언급하지만 머신러닝 기반의 회귀는 회귀계수를 기반으로 하는 <code>최적 회귀 함수를 도출하는 것이 주요 목표</code>이다. 이번엔 회귀 함수를 기반으로 하지 않고 결정 트리와 같이 트리를 기반으로 하는 회귀방식으로 소개하겠다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="&#54924;&#44480;-&#53944;&#47532;"><strong><em><code>&#54924;&#44480; &#53944;&#47532;</code></em></strong><a class="anchor-link" href="#&#54924;&#44480;-&#53944;&#47532;"> </a></h3><p>즉 회귀를 위한 트리를 생성하고 이를 기반으로 회귀 예측을 하는 것이다. 분류 트리와 크게 다르지 않다. 다만 리프 노드에서 예측 결정 값을 만드는 과정에 차이가 있는데 분류 트리가 특정 클래스 레이블을 결정하는 것과 달리 회귀 트리는 리프 노드에 속한 데이터 값을 평균값을 구해 회귀 예측값을 계산한다. 리프 노드 생성 기준에 부합하는 트리 분할이 완료됐다면 리프 노드에 소속된 데이터 값의 평균값을 구해서 최종적으로 리프 노드에 결정 값으로 할당한다.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>사이킷런의 랜덤 포레스트 회귀 트리인 RandomForestRegressor를 이용해 앞의 선형 회귀에서 다룬 보스턴 주택 가격 예측을 수행해보자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># 보스턴 데이터 세트 로드</span>
<span class="n">boston</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>
<span class="n">bostonDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>

<span class="n">bostonDF</span><span class="p">[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">bostonDF</span><span class="p">[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]</span>
<span class="n">X_data</span> <span class="o">=</span> <span class="n">bostonDF</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PRICE&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">neg_mse_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_target</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">rmse_scores</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">neg_mse_scores</span><span class="p">)</span>
<span class="n">avg_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_scores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; 5 교차 검증의 개별 Negative MSE scores: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">neg_mse_scores</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; 5 교차 검증의 개별 RMSE scores : &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmse_scores</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; 5 교차 검증의 평균 RMSE : </span><span class="si">{0:.3f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_rmse</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> 5 교차 검증의 개별 Negative MSE scores:  [ -7.88 -13.14 -20.57 -46.23 -18.88]
 5 교차 검증의 개별 RMSE scores :  [2.81 3.63 4.54 6.8  4.34]
 5 교차 검증의 평균 RMSE : 4.423 
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번에는 랜덤 포레스트뿐만 아니라 결정 트리, GBM, XGBoost, LightGBM의 Regressor를 모두 이용해 예측을 수행해보자. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>아래 함수는 입력 모델과 데이터 세트를 입력 받아 교차 검증으로 평균 RMSE를 계산해주는 함수이다.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_model_cv_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_target</span><span class="p">):</span>
    <span class="n">neg_mse_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_target</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">rmse_scores</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">neg_mse_scores</span><span class="p">)</span>
    <span class="n">avg_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_scores</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;##### &#39;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="p">,</span> <span class="s1">&#39; #####&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; 5 교차 검증의 평균 RMSE : </span><span class="si">{0:.3f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_rmse</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 다양한 유형의 회귀 트리를 생성하고 이를 이용해 가격을 예측해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMRegressor</span>

<span class="n">dt_reg</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rf_reg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">gb_reg</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">xgb_reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">lgb_reg</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># 트리 기반의 회귀 모델을 반복하면서 평가 수행 </span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt_reg</span><span class="p">,</span> <span class="n">rf_reg</span><span class="p">,</span> <span class="n">gb_reg</span><span class="p">,</span> <span class="n">xgb_reg</span><span class="p">,</span> <span class="n">lgb_reg</span><span class="p">]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>  
    <span class="n">get_model_cv_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>#####  DecisionTreeRegressor  #####
 5 교차 검증의 평균 RMSE : 5.978 
#####  RandomForestRegressor  #####
 5 교차 검증의 평균 RMSE : 4.423 
#####  GradientBoostingRegressor  #####
 5 교차 검증의 평균 RMSE : 4.269 
#####  XGBRegressor  #####
 5 교차 검증의 평균 RMSE : 4.251 
#####  LGBMRegressor  #####
 5 교차 검증의 평균 RMSE : 4.646 
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>회귀 트리 Regressor 클래스는 선형 회귀와 다른 처리 방식이므로 회귀 계수를 제공하는 coef_ 속성이 없다. 대신 feature별 중요도를 알아보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">rf_reg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># 앞 예제에서 만들어진 X_data, y_target 데이터 셋을 적용하여 학습합니다.   </span>
<span class="n">rf_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_data</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>

<span class="n">feature_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rf_reg</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_data</span><span class="o">.</span><span class="n">columns</span> <span class="p">)</span>
<span class="n">feature_series</span> <span class="o">=</span> <span class="n">feature_series</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">feature_series</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">feature_series</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번에는 회귀 트리 Regressor가 어떻게 예측값을 판단하는 선형 회귀와 비교해 시각화해보자. 결정 트리의 하이퍼 파라미터인 max_depth의 크기를 변화시키면서 어떻게 회귀 트리 예측선이 변화하는지 살펴보자. 회귀 예측선을 쉽게 표현하귀 위해서 단 1개의 변수만 추출하자. 일단 이 데이터 세트를 시각화 해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">bostonDF_sample</span> <span class="o">=</span> <span class="n">bostonDF</span><span class="p">[[</span><span class="s1">&#39;RM&#39;</span><span class="p">,</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]]</span>
<span class="n">bostonDF_sample</span> <span class="o">=</span> <span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">RM</span> <span class="p">,</span> <span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">PRICE</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 2)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1ca1cd27880&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>다음으로 보스턴 데이터 세트에 대해 LinearRegression과 DecisionTreeRegressor를 max_depth를 각각 2,7로 학습해보자. 이렇게 학습된 Regressor에 RM feature값을 4.5~8.5까지의 100개의 테스트 데이터 세트로 제공했을 때 예측값을 구하자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># 선형 회귀와 결정 트리 기반의 Regressor 생성. DecisionTreeRegressor의 max_depth는 각각 2, 7</span>
<span class="n">lr_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">rf_reg2</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rf_reg7</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="c1"># 실제 예측을 적용할 테스트용 데이터 셋을 4.5 ~ 8.5 까지 100개 데이터 셋 생성. </span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 보스턴 주택가격 데이터에서 시각화를 위해 피처는 RM만, 그리고 결정 데이터인 PRICE 추출</span>
<span class="n">X_feature</span> <span class="o">=</span> <span class="n">bostonDF_sample</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">bostonDF_sample</span><span class="p">[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 학습과 예측 수행. </span>
<span class="n">lr_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_feature</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>
<span class="n">rf_reg2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_feature</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>
<span class="n">rf_reg7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_feature</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>

<span class="n">pred_lr</span> <span class="o">=</span> <span class="n">lr_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pred_rf2</span> <span class="o">=</span> <span class="n">rf_reg2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pred_rf7</span> <span class="o">=</span> <span class="n">rf_reg7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>학습된 Regressor에서 예측한  Price 회귀선을 그려보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># X축값을 4.5 ~ 8.5로 변환하며 입력했을 때, 선형 회귀와 결정 트리 회귀 예측 선 시각화</span>
<span class="c1"># 선형 회귀로 학습된 모델 회귀 예측선 </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">RM</span><span class="p">,</span> <span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">PRICE</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">pred_lr</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>

<span class="c1"># DecisionTreeRegressor의 max_depth를 2로 했을 때 회귀 예측선 </span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Decision Tree Regression: </span><span class="se">\n</span><span class="s1"> max_depth=2&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">RM</span><span class="p">,</span> <span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">PRICE</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">pred_rf2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;max_depth:3&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>

<span class="c1"># DecisionTreeRegressor의 max_depth를 7로 했을 때 회귀 예측선 </span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Decision Tree Regression: </span><span class="se">\n</span><span class="s1"> max_depth=7&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">RM</span><span class="p">,</span> <span class="n">bostonDF_sample</span><span class="o">.</span><span class="n">PRICE</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">pred_rf7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;max_depth:7&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1ca1d4d4280&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>선형 회귀는 직선으로 예측 회귀선을 표현하는 데 반해, 회귀 트리의 경우 분할되는 데이터 지점에 따라 브랜치를 만들면서 계단 형태로 회귀선을 만든다. max_depth가 7인 경우에는 학습 데이터 세트의 이상치 데이터도 학습하면서 복잡한 계단 형태의 회귀선을 만들어 과적합이 되기 쉬운 모델이 되었음을 알 수 있다.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h3 id="&#51088;&#51204;&#44144;-&#45824;&#50668;-&#49688;&#50836;-&#50696;&#52769;"><strong><em><code>&#51088;&#51204;&#44144; &#45824;&#50668; &#49688;&#50836; &#50696;&#52769;</code></em></strong><a class="anchor-link" href="#&#51088;&#51204;&#44144;-&#45824;&#50668;-&#49688;&#50836;-&#50696;&#52769;"> </a></h3>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>데이터 클렌징 및 가공, 데이터 세트를 이용해 모델을 학습한 후 대여 횟수를 예측해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>

<span class="n">bike_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./bike_train.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bike_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">bike_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(10886, 12)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bike_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 12 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   datetime    10886 non-null  object 
 1   season      10886 non-null  int64  
 2   holiday     10886 non-null  int64  
 3   workingday  10886 non-null  int64  
 4   weather     10886 non-null  int64  
 5   temp        10886 non-null  float64
 6   atemp       10886 non-null  float64
 7   humidity    10886 non-null  int64  
 8   windspeed   10886 non-null  float64
 9   casual      10886 non-null  int64  
 10  registered  10886 non-null  int64  
 11  count       10886 non-null  int64  
dtypes: float64(3), int64(8), object(1)
memory usage: 1020.7+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>null 데이터는 없으며, datetime만 type이 object이다. 일단 이 column에 대해 알아보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bike_df</span><span class="p">[[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>10881</th>
      <td>2012-12-19 19:00:00</td>
    </tr>
    <tr>
      <th>10882</th>
      <td>2012-12-19 20:00:00</td>
    </tr>
    <tr>
      <th>10883</th>
      <td>2012-12-19 21:00:00</td>
    </tr>
    <tr>
      <th>10884</th>
      <td>2012-12-19 22:00:00</td>
    </tr>
    <tr>
      <th>10885</th>
      <td>2012-12-19 23:00:00</td>
    </tr>
  </tbody>
</table>
<p>10886 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 년,월,일,시간 형식으로 돼 있으므로 이에 대한 적절한 가공이 필요하다. 이를 각각 분리하자. 판다스에서는 datetime과 같은 형태의 문자열을 년,월,일,시간,분,초로 편리하게 변환하려면 먼저 문자열을 datetime으로 변경해야한다. (<strong><em>우연히 판다스의 datetime 타입과 예제 데이터 세트의 datetime column명이 동일한 것이지 둘을 혼동해선 안 된다</em></strong>)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">)</span>
<span class="n">bike_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 12 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   datetime    10886 non-null  datetime64[ns]
 1   season      10886 non-null  int64         
 2   holiday     10886 non-null  int64         
 3   workingday  10886 non-null  int64         
 4   weather     10886 non-null  int64         
 5   temp        10886 non-null  float64       
 6   atemp       10886 non-null  float64       
 7   humidity    10886 non-null  int64         
 8   windspeed   10886 non-null  float64       
 9   casual      10886 non-null  int64         
 10  registered  10886 non-null  int64         
 11  count       10886 non-null  int64         
dtypes: datetime64[ns](1), float64(3), int64(8)
memory usage: 1020.7 KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>datetime column의 type이 datetime64로 적절히 변경된 것을 알 수 있다.</li>
<li>간단히 살펴보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bike_df</span><span class="p">[[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>겉으로 보기엔 바뀐 게 없어보이지만 아마 type은 잘 바뀌었을 것이다. </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bike_df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">bike_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10886 entries, 0 to 10885
Data columns (total 16 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   datetime    10886 non-null  datetime64[ns]
 1   season      10886 non-null  int64         
 2   holiday     10886 non-null  int64         
 3   workingday  10886 non-null  int64         
 4   weather     10886 non-null  int64         
 5   temp        10886 non-null  float64       
 6   atemp       10886 non-null  float64       
 7   humidity    10886 non-null  int64         
 8   windspeed   10886 non-null  float64       
 9   casual      10886 non-null  int64         
 10  registered  10886 non-null  int64         
 11  count       10886 non-null  int64         
 12  year        10886 non-null  int64         
 13  month       10886 non-null  int64         
 14  day         10886 non-null  int64         
 15  hour        10886 non-null  int64         
dtypes: datetime64[ns](1), float64(3), int64(12)
memory usage: 1.3 MB
None
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drop_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span><span class="s1">&#39;casual&#39;</span><span class="p">,</span><span class="s1">&#39;registered&#39;</span><span class="p">]</span>
<span class="n">bike_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>기존의 datetime column은 삭제했고, casual,resistered의 합이 count이므로 불필요하기에 같이 삭제하겠음. 오히려 상관도가 높아 예측을 저해할 우려가 있으므로 삭제함.</li>
<li>다양한 회귀 모델을 데이터 세트에 적용해 예측 성능을 측정해보자 </li>
<li>사이킷런에서는 RMSLE를 제공하지 않기 때문에 이를 수행하는 함수를 직접 만들어보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># log 값 변환 시 언더플로우 영향으로 log() 가 아닌 log1p() 를 이용하여 RMSLE 계산</span>
<span class="k">def</span> <span class="nf">rmsle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="n">log_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">log_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">squared_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">log_y</span> <span class="o">-</span> <span class="n">log_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">rmsle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">squared_error</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">rmsle</span>

<span class="c1"># 사이킷런의 mean_square_error() 를 이용하여 RMSE 계산</span>
<span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">))</span>

<span class="c1"># 책에서는 mean_absolute_error()를 MSE로 잘못 기재함. </span>
<span class="c1"># MAE, RMSE, RMSLE 를 모두 계산 </span>
<span class="k">def</span> <span class="nf">evaluate_regr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">):</span>
    <span class="n">rmsle_val</span> <span class="o">=</span> <span class="n">rmsle</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">rmse_val</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>
    <span class="c1"># MAE 는 scikit learn의 mean_absolute_error() 로 계산</span>
    <span class="n">mae_val</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSLE: </span><span class="si">{0:.3f}</span><span class="s1">, RMSE: </span><span class="si">{1:.3F}</span><span class="s1">, MAE: </span><span class="si">{2:.3F}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmsle_val</span><span class="p">,</span> <span class="n">rmse_val</span><span class="p">,</span> <span class="n">mae_val</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h4 id="&#47196;&#44536;-&#48320;&#54872;,-feature-&#51064;&#53076;&#46377;&#44284;-&#47784;&#45944;-&#54617;&#49845;,&#50696;&#52769;,&#54217;&#44032;">&#47196;&#44536; &#48320;&#54872;, feature &#51064;&#53076;&#46377;&#44284; &#47784;&#45944; &#54617;&#49845;,&#50696;&#52769;,&#54217;&#44032;<a class="anchor-link" href="#&#47196;&#44536;-&#48320;&#54872;,-feature-&#51064;&#53076;&#46377;&#44284;-&#47784;&#45944;-&#54617;&#49845;,&#50696;&#52769;,&#54217;&#44032;"> </a></h4><p>이제 회귀 모델을 이용해 자전거 대혀 횟수를 예측해보자. 회귀 모델을 적용하기 전에 데이터 세트에 대해서 먼저 처리해야할 사항이 있다. 결괏값이 정규 분포로 돼 있는지 확인하는 것과 카테고리형 회귀 모델의 경우 원-핫 인코딩으로 feature를 인코딩하는 것이다.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>먼저 사이킷런의 LinearRegression 객체를 이용해 회귀 예측을 해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span> <span class="p">,</span> <span class="n">Ridge</span> <span class="p">,</span> <span class="n">Lasso</span>

<span class="n">y_target</span> <span class="o">=</span> <span class="n">bike_df</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">bike_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lr_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">lr_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">evaluate_regr</span><span class="p">(</span><span class="n">y_test</span> <span class="p">,</span><span class="n">pred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>RMSLE: 1.165, RMSE: 140.900, MAE: 105.924
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>실제 Target 데이터 값인 횟수 (count)를 감안하면 예측 오류로서는 비교적 큰 값이다. 실제 값과 예측값이 어느 정도 차이가 나는지 DataFrame의 column으로 만들어서 오류 값이 가장 큰 순으로 5개만 확인해보자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_top_error_data</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">n_tops</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
    <span class="c1"># DataFrame에 컬럼들로 실제 대여횟수(count)와 예측 값을 서로 비교 할 수 있도록 생성. </span>
    <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;real_count&#39;</span><span class="p">])</span>
    <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;predicted_count&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;real_count&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;predicted_count&#39;</span><span class="p">])</span>
    <span class="c1"># 예측값과 실제값이 가장 큰 데이터 순으로 출력. </span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="n">n_tops</span><span class="p">])</span>
    
<span class="n">get_top_error_data</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">pred</span><span class="p">,</span><span class="n">n_tops</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>      real_count  predicted_count   diff
1618         890            322.0  568.0
3151         798            241.0  557.0
966          884            327.0  557.0
412          745            194.0  551.0
2817         856            310.0  546.0
2277         813            267.0  546.0
2314         766            222.0  544.0
454          721            177.0  544.0
1003         713            171.0  542.0
2394         684            142.0  542.0
1181         891            357.0  534.0
1379         745            212.0  533.0
2003         770            241.0  529.0
1029         901            378.0  523.0
3227         724            202.0  522.0
1038         873            353.0  520.0
3197         694            176.0  518.0
507          688            174.0  514.0
637          900            393.0  507.0
87           594             95.0  499.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>회귀에서 이렇게 큰 예측 오류가 발생할 경우 가장 먼저 살펴볼 것은 Target 값의 분포가 왜곡된 형태를 이루고 있는지 확인하는 것이다. Target 값의 분포는 정규 분포 형태가 가장 좋다. 그렇지 않고 왜곡된 경우에는 회귀 예측 성능이 저하되는 경우가 발생하기 쉽다. pandas의 DataFrame의 hist()를 이용해 자전거 대여 모델의 Target 값이 count column이 정규분포를 이루는지 확인해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_target</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYEAAAD4CAYAAAAKA1qZAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAXTklEQVR4nO3df4xVZ53H8fdn6c+trlDbvUEgOxhZDUqkzaStqX/cbVdKqZGaVENDLFY24yY0Wzez64K7SdVKUhMRNdHG0WLRuCJbdUsoaxdpTwx/9BeKbQG7HS0uTGhRodWLsXHY7/5xnqFXnGHuvXO5t3Ofzyu5mXO+5znnPN97Br5zzj3nPooIzMwsT3/W7Q6YmVn3uAiYmWXMRcDMLGMuAmZmGXMRMDPL2Dnd7sCZXHLJJdHX19fSuidOnOCiiy5qb4emiVxzd975yTX3yfLes2fPryLi0ka29aouAn19fTzxxBMtrVsUBdVqtb0dmiZyzd155yfX3CfLW9IvGt2WLweZmWXMRcDMLGMuAmZmGXMRMDPLmIuAmVnGXATMzDLmImBmljEXATOzjLkImJll7FX9xPBU9a19oCv7PXjXDV3Zr5lZs3wmYGaWMRcBM7OMuQiYmWXMRcDMLGMuAmZmGXMRMDPLmIuAmVnGXATMzDLmImBmlrGGi4CkGZJ+LGl7mp8v6VFJw5K+Lem8FD8/zQ+n5X1121iX4s9Iuq7t2ZiZWVOaORO4HThQN/9pYGNEvAk4DqxO8dXA8RTfmNohaSGwAngrsBT4kqQZU+u+mZlNRUNFQNJc4Abgq2lewDXAfanJZuDGNL08zZOWX5vaLwe2RMTLEfEcMAxc0YYczMysRY1+gdzngI8Cr03zrwdejIjRNH8YmJOm5wCHACJiVNJLqf0c4JG6bdavc4qkAWAAoFKpUBRFg138Y7VajcFFJ1tad6pa7XO71Gq1rvehG5x3fnLNvZ15T1oEJL0bOBoReyRV27LXM4iIIWAIoL+/P6rV1nZZFAUbdp9oY88ad3BltSv7HVMUBa2+b9OZ885Prrm3M+9GzgSuBt4jaRlwAfAXwOeBmZLOSWcDc4GR1H4EmAcclnQO8Drg13XxMfXrmJlZF0z6mUBErIuIuRHRR/nB7kMRsRJ4GLgpNVsF3J+mt6V50vKHIiJSfEW6e2g+sAB4rG2ZmJlZ06YyqMy/AFskfQr4MXBPit8DfEPSMHCMsnAQEfskbQX2A6PAmojozkV7MzMDmiwCEVEARZr+OePc3RMRvwfeN8H664H1zXbSzMzODj8xbGaWMRcBM7OMuQiYmWXMRcDMLGMuAmZmGXMRMDPLmIuAmVnGXATMzDLmImBmljEXATOzjLkImJllzEXAzCxjLgJmZhlzETAzy5iLgJlZxiYtApIukPSYpJ9I2ifpEyl+r6TnJO1Nr8UpLklfkDQs6UlJl9dta5WkZ9Nr1QS7NDOzDmlkUJmXgWsioibpXGC3pP9Ky/45Iu47rf31lENHLgCuBO4GrpR0MXAH0A8EsEfStog43o5EzMyseY2MMRwRUUuz56ZXnGGV5cDX03qPUA5IPxu4DtgZEcfSf/w7gaVT676ZmU1FQ58JSJohaS9wlPI/8kfTovXpks9GSeen2BzgUN3qh1NsoriZmXVJQ2MMpwHhF0uaCXxP0tuAdcDzwHnAEOXA85+caockDQADAJVKhaIoWtpOrVZjcFF3xrFvtc/tUqvVut6HbnDe+ck193bm3exA8y9KehhYGhGfSeGXJX0N+Kc0PwLMq1ttboqNANXT4sU4+xiiLCr09/dHtVo9vUlDiqJgw+4TLa07VQdXVruy3zFFUdDq+zadOe/85Jp7O/Nu5O6gS9MZAJIuBN4F/DRd50eSgBuBp9Mq24Bb0l1CVwEvRcQR4EFgiaRZkmYBS1LMzMy6pJEzgdnAZkkzKIvG1ojYLukhSZcCAvYCf5/a7wCWAcPA74BbASLimKQ7gcdTu09GxLG2ZWJmZk2btAhExJPAZePEr5mgfQBrJli2CdjUZB/NzOws8RPDZmYZcxEwM8uYi4CZWcZcBMzMMuYiYGaWMRcBM7OMuQiYmWXMRcDMLGMuAmZmGXMRMDPLmIuAmVnGXATMzDLmImBmljEXATOzjLkImJllzEXAzCxjjQwveYGkxyT9RNI+SZ9I8fmSHpU0LOnbks5L8fPT/HBa3le3rXUp/oyk685aVmZm1pBGzgReBq6JiLcDi4GlaezgTwMbI+JNwHFgdWq/Gjie4htTOyQtBFYAbwWWAl9KQ1aamVmXTFoEolRLs+emVwDXAPel+GbKweYBlqd50vJr02D0y4EtEfFyRDxHOQbxFe1IwszMWtPIQPOkv9j3AG8Cvgj8DHgxIkZTk8PAnDQ9BzgEEBGjkl4CXp/ij9Rttn6d+n0NAAMAlUqFoiiayyip1WoMLjrZ0rpT1Wqf26VWq3W9D93gvPOTa+7tzLuhIhARJ4HFkmYC3wPe0pa9j7+vIWAIoL+/P6rVakvbKYqCDbtPtLFnjTu4stqV/Y4pioJW37fpzHnnJ9fc25l3U3cHRcSLwMPAO4CZksaKyFxgJE2PAPMA0vLXAb+uj4+zjpmZdUEjdwddms4AkHQh8C7gAGUxuCk1WwXcn6a3pXnS8ociIlJ8Rbp7aD6wAHisTXmYmVkLGrkcNBvYnD4X+DNga0Rsl7Qf2CLpU8CPgXtS+3uAb0gaBo5R3hFEROyTtBXYD4wCa9JlJjMz65JJi0BEPAlcNk7854xzd09E/B543wTbWg+sb76bZmZ2NviJYTOzjLkImJllzEXAzCxjLgJmZhlzETAzy5iLgJlZxlwEzMwy5iJgZpYxFwEzs4y5CJiZZcxFwMwsYy4CZmYZcxEwM8uYi4CZWcZcBMzMMtbIyGLzJD0sab+kfZJuT/GPSxqRtDe9ltWts07SsKRnJF1XF1+aYsOS1p6dlMzMrFGNjCw2CgxGxI8kvRbYI2lnWrYxIj5T31jSQsrRxN4KvAH4gaS/Tou/SDk85WHgcUnbImJ/OxIxM7PmNTKy2BHgSJr+raQDwJwzrLIc2BIRLwPPpWEmx0YgG04jkiFpS2rrImBm1iWNnAmcIqmPcqjJR4Grgdsk3QI8QXm2cJyyQDxSt9phXikah06LXznOPgaAAYBKpUJRFM108ZRarcbgou4MYdxqn9ulVqt1vQ/d4Lzzk2vu7cy74SIg6TXAd4CPRMRvJN0N3AlE+rkB+NBUOxQRQ8AQQH9/f1Sr1Za2UxQFG3afmGp3WnJwZbUr+x1TFAWtvm/TmfPOT665tzPvhoqApHMpC8A3I+K7ABHxQt3yrwDb0+wIMK9u9bkpxhniZmbWBY3cHSTgHuBARHy2Lj67rtl7gafT9DZghaTzJc0HFgCPAY8DCyTNl3Qe5YfH29qThpmZtaKRM4GrgQ8AT0nam2IfA26WtJjyctBB4MMAEbFP0lbKD3xHgTURcRJA0m3Ag8AMYFNE7GtbJmZm1rRG7g7aDWicRTvOsM56YP048R1nWs/MzDrLTwybmWXMRcDMLGNNPSdgjelb+0DX9n3wrhu6tm8zm358JmBmljEXATOzjLkImJllzEXAzCxjLgJmZhlzETAzy5iLgJlZxlwEzMwy5iJgZpYxFwEzs4y5CJiZZcxFwMwsY42MLDZP0sOS9kvaJ+n2FL9Y0k5Jz6afs1Jckr4gaVjSk5Iur9vWqtT+WUmrzl5aZmbWiEbOBEaBwYhYCFwFrJG0EFgL7IqIBcCuNA9wPeWQkguAAeBuKIsGcAdwJXAFcMdY4TAzs+6YtAhExJGI+FGa/i1wAJgDLAc2p2abgRvT9HLg61F6BJiZxiO+DtgZEcci4jiwE1jazmTMzKw5TY0nIKkPuAx4FKhExJG06HmgkqbnAIfqVjucYhPFT9/HAOUZBJVKhaIomuniKbVajcFFJ1tadzorioJardby+zadOe/85Jp7O/NuuAhIeg3wHeAjEfEb6ZVhhyMiJEU7OhQRQ8AQQH9/f1Sr1Za2UxQFG3afaEeXppWDK6sURUGr79t05rzzk2vu7cy7obuDJJ1LWQC+GRHfTeEX0mUe0s+jKT4CzKtbfW6KTRQ3M7MuaeTuIAH3AAci4rN1i7YBY3f4rALur4vfku4Sugp4KV02ehBYImlW+kB4SYqZmVmXNHI56GrgA8BTkvam2MeAu4CtklYDvwDen5btAJYBw8DvgFsBIuKYpDuBx1O7T0bEsXYkYWZmrZm0CETEbkATLL52nPYBrJlgW5uATc100MzMzh4/MWxmljEXATOzjLkImJllzEXAzCxjLgJmZhlzETAzy5iLgJlZxlwEzMwy5iJgZpaxpr5K2l79+tY+wOCiUT649oGO7vfgXTd0dH9m1h4+EzAzy5iLgJlZxlwEzMwy5iJgZpYxFwEzs4w1MrLYJklHJT1dF/u4pBFJe9NrWd2ydZKGJT0j6bq6+NIUG5a0tv2pmJlZsxo5E7gXWDpOfGNELE6vHQCSFgIrgLemdb4kaYakGcAXgeuBhcDNqa2ZmXVRIyOL/VBSX4PbWw5siYiXgeckDQNXpGXDEfFzAElbUtv9zXfZzMzaZSoPi90m6RbgCWAwIo4Dc4BH6tocTjGAQ6fFrxxvo5IGgAGASqVCURQtda5WqzG46GRL6053lQthcNFoR/fZ6nFqp1qt9qroR6flmjfkm3s78261CNwN3AlE+rkB+FA7OhQRQ8AQQH9/f1Sr1Za2UxQFG3afaEeXpp3BRaNseKqzD4MfXFnt6P7GUxQFrf6+TGe55g355t7OvFv6nyIiXhiblvQVYHuaHQHm1TWdm2KcIW5mZl3S0i2ikmbXzb4XGLtzaBuwQtL5kuYDC4DHgMeBBZLmSzqP8sPjba1328zM2mHSMwFJ3wKqwCWSDgN3AFVJiykvBx0EPgwQEfskbaX8wHcUWBMRJ9N2bgMeBGYAmyJiX7uTMTOz5jRyd9DN44TvOUP79cD6ceI7gB1N9c7MzM4qPzFsZpYxFwEzs4y5CJiZZcxFwMwsYy4CZmYZcxEwM8uYi4CZWcZcBMzMMuYiYGaWMRcBM7OMuQiYmWXMRcDMLGMuAmZmGXMRMDPLmIuAmVnGGhlUZhPwbuBoRLwtxS4Gvg30UQ4q8/6IOC5JwOeBZcDvgA9GxI/SOquAf0ub/VREbG5vKtZNfWsf6Mp+D951Q1f2a9YrGjkTuBdYelpsLbArIhYAu9I8wPWUQ0ouAAYoB6QfKxp3AFcCVwB3SJo11c6bmdnUTFoEIuKHwLHTwsuBsb/kNwM31sW/HqVHgJlpPOLrgJ0RcSwijgM7+dPCYmZmHTbp5aAJVCLiSJp+Hqik6TnAobp2h1NsovifkDRAeRZBpVKhKIqWOlir1RhcdLKldae7yoUwuGi0293oiPrfj1qt1vLvy3SWa96Qb+7tzLvVInBKRISkaEdn0vaGgCGA/v7+qFarLW2nKAo27D7Rrm5NK4OLRtnw1JQP7bRwcGX11HRRFLT6+zKd5Zo35Jt7O/Nu9e6gF9JlHtLPoyk+Asyrazc3xSaKm5lZF7VaBLYBq9L0KuD+uvgtKl0FvJQuGz0ILJE0K30gvCTFzMysixq5RfRbQBW4RNJhyrt87gK2SloN/AJ4f2q+g/L20GHKW0RvBYiIY5LuBB5P7T4ZEad/2GxmZh02aRGIiJsnWHTtOG0DWDPBdjYBm5rqnZmZnVV+YtjMLGMuAmZmGXMRMDPLmIuAmVnGXATMzDLmImBmljEXATOzjLkImJllzEXAzCxjLgJmZhlzETAzy5iLgJlZxvIYecR6Vv0A94OLRvlgBwe89yD31gt8JmBmljEXATOzjE2pCEg6KOkpSXslPZFiF0vaKenZ9HNWikvSFyQNS3pS0uXtSMDMzFrXjjOBv4mIxRHRn+bXArsiYgGwK80DXA8sSK8B4O427NvMzKbgbFwOWg5sTtObgRvr4l+P0iPAzLHB6s3MrDumWgQC+G9JeyQNpFglDS4P8DxQSdNzgEN16x5OMTMz65Kp3iL6zogYkfSXwE5JP61fGBEhKZrZYComAwCVSoWiKFrqWK1WY3DRyZbWne4qF5a3S+am03m3+rvZbrVa7VXTl07LNfd25j2lIhARI+nnUUnfA64AXpA0OyKOpMs9R1PzEWBe3epzU+z0bQ4BQwD9/f1RrVZb6ltRFGzYfaKldae7wUWjbHgqv0dAOp33wZXVju3rTIqioNV/J9Ndrrm3M++WLwdJukjSa8emgSXA08A2YFVqtgq4P01vA25JdwldBbxUd9nIzMy6YCp/NlWA70ka286/R8T3JT0ObJW0GvgF8P7UfgewDBgGfgfcOoV9m3VdXwefTq7nJ5WtnVouAhHxc+Dt48R/DVw7TjyANa3uz8zM2s9PDJuZZcxFwMwsYy4CZmYZcxEwM8uYi4CZWcZcBMzMMuYiYGaWMRcBM7OM5fcFM2bT3OlPKndybGU/rdx7fCZgZpYxFwEzs4y5CJiZZcxFwMwsY/5g2Mwa5q/P7j0+EzAzy5jPBMzsVW+iM5BO3B7b62chHT8TkLRU0jOShiWt7fT+zczsFR0tApJmAF8ErgcWAjdLWtjJPpiZ2Ss6fTnoCmA4DU2JpC3AcmB/h/thZtaQXv8wXOXQv50h6SZgaUT8XZr/AHBlRNxW12YAGEizbwaeaXF3lwC/mkJ3p7Ncc3fe+ck198ny/quIuLSRDb3qPhiOiCFgaKrbkfRERPS3oUvTTq65O+/85Jp7O/Pu9AfDI8C8uvm5KWZmZl3Q6SLwOLBA0nxJ5wErgG0d7oOZmSUdvRwUEaOSbgMeBGYAmyJi31na3ZQvKU1juebuvPOTa+5ty7ujHwybmdmri782wswsYy4CZmYZ68ki0MtfTSFpnqSHJe2XtE/S7Sl+saSdkp5NP2eluCR9Ib0XT0q6vLsZTI2kGZJ+LGl7mp8v6dGU37fTDQdIOj/ND6flfV3t+BRJminpPkk/lXRA0jtyOOaS/jH9nj8t6VuSLujVYy5pk6Sjkp6uizV9jCWtSu2flbRqsv32XBHI4KspRoHBiFgIXAWsSfmtBXZFxAJgV5qH8n1YkF4DwN2d73Jb3Q4cqJv/NLAxIt4EHAdWp/hq4HiKb0ztprPPA9+PiLcAb6d8D3r6mEuaA/wD0B8Rb6O8mWQFvXvM7wWWnhZr6hhLuhi4A7iS8hsa7hgrHBOKiJ56Ae8AHqybXwes63a/zmK+9wPvonyyenaKzQaeSdNfBm6ua3+q3XR7UT5Xsgu4BtgOiPKpyXNOP/aUd6C9I02fk9qp2zm0mPfrgOdO73+vH3NgDnAIuDgdw+3Adb18zIE+4OlWjzFwM/DluvgftRvv1XNnArzyizPmcIr1nHS6exnwKFCJiCNp0fNAJU330vvxOeCjwP+l+dcDL0bEaJqvz+1U3mn5S6n9dDQf+CXwtXQp7KuSLqLHj3lEjACfAf4XOEJ5DPeQxzEf0+wxbvrY92IRyIKk1wDfAT4SEb+pXxblnwA9de+vpHcDRyNiT7f70gXnAJcDd0fEZcAJXrksAPTsMZ9F+QWT84E3ABfxp5dLsnG2jnEvFoGe/2oKSedSFoBvRsR3U/gFSbPT8tnA0RTvlffjauA9kg4CWygvCX0emClp7KHH+txO5Z2Wvw74dSc73EaHgcMR8Wiav4+yKPT6Mf9b4LmI+GVE/AH4LuXvQQ7HfEyzx7jpY9+LRaCnv5pCkoB7gAMR8dm6RduAsTsBVlF+VjAWvyXdTXAV8FLd6eW0ERHrImJuRPRRHtOHImIl8DBwU2p2et5j78dNqf20/Es5Ip4HDkl6cwpdS/n16z19zCkvA10l6c/T7/1Y3j1/zOs0e4wfBJZImpXOpJak2MS6/UHIWfpwZRnwP8DPgH/tdn/anNs7KU8JnwT2ptcyymufu4BngR8AF6f2orxb6mfAU5R3WnQ9jym+B1Vge5p+I/AYMAz8B3B+il+Q5ofT8jd2u99TzHkx8EQ67v8JzMrhmAOfAH4KPA18Azi/V4858C3Kzz7+QHn2t7qVYwx8KL0Hw8Ctk+3XXxthZpaxXrwcZGZmDXIRMDPLmIuAmVnGXATMzDLmImBmljEXATOzjLkImJll7P8Bo9pM3lWOlEUAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>count column이 0~200사이에 왜곡돼 있는 것을 확인할 수 있다. 이렇게 왜곡도니 값을 정규 분포 형태로 바꾸는 가장 일반적인 방법을 로그를 적용해 변환하는 것이다. </li>
<li>이렇게 로그값으로 변경된 Target값은 다시 expm1() 함수를 적용해 원래 scale 값으로 원상복구하면 된다. </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_log_transform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">y_target</span><span class="p">)</span>
<span class="n">y_log_transform</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>정규 분포와 흡사하진 않지만 변환하기 전보다는 왜곡 정도가 많이 향상됐음을 알 수 있다. </li>
<li>다시 학습한 후 성능을 평가해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_target_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">y_target</span><span class="p">)</span>

<span class="c1"># 로그 변환된 y_target_log를 반영하여 학습/테스트 데이터 셋 분할</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y_target_log</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lr_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">lr_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># 테스트 데이터 셋의 Target 값은 Log 변환되었으므로 다시 expm1를 이용하여 원래 scale로 변환</span>
<span class="n">y_test_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="c1"># 예측 값 역시 Log 변환된 타겟 기반으로 학습되어 예측되었으므로 다시 exmpl으로 scale변환</span>
<span class="n">pred_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

<span class="n">evaluate_regr</span><span class="p">(</span><span class="n">y_test_exp</span> <span class="p">,</span><span class="n">pred_exp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>RMSLE: 1.017, RMSE: 162.594, MAE: 109.286
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>RMSLE 오류는 줄어들었지만 RMSE는 오히려 더 늘어났다. 왜???????</li>
<li>일단 각 feature의 회귀 계수값을 시각화 해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lr_reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">coef_sort</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coef_sort</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">coef_sort</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZ4AAAD4CAYAAADcpoD8AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAb4klEQVR4nO3dfbxd45338c9Xau6EIK1kWm1xppFOKkHIoVIPRY2iSowYLdoGQ1FN+3Jzc7eqofUamvZuaVWFIVSqiMehEiYRIpLIOeRBxFMlHaZGw4gyHiu/+491HVk53SfnIWevtffZ3/frlZe1rnWttX6XvOrX61prr58iAjMzs6JsVHYAZmbWWJx4zMysUE48ZmZWKCceMzMrlBOPmZkV6gNlB1DrBg8eHE1NTWWHYWZWV1pbW1+KiCGVjjnxdKKpqYmWlpaywzAzqyuS/tDRMSceY9Vl15UdgpnVoCGnHFuV6/oZj5mZFcqJx8zMCuXEY2ZmhXLiMTOzQjV84pHUr+wYzMwaSV0lHknnS/p2bv8CSd+SdKakhZKWSDovd/w2Sa2Slkk6Kdf+uqSfSFoMjCl2FGZmja2uEg9wFfBVAEkbAV8C/gsYBuwGjAJGS9o79T8+IkYDzcAESVum9k2BBRGxU0Q82P4mkk6S1CKpZdWqVVUdkJlZo6mrxBMRK4GXJe0MHAA8Cuya234EGE6WiCBLNouB+cDWufb3gJvXc5/JEdEcEc1DhlT84a2ZmfVQPf6A9EpgPPARshnQ54B/iYjL850k7QPsD4yJiDckzQb6p8NvRcR7BcVrZmY5dTXjSW4FDiSb6cxIf46XNBBA0sck/S2wBfBKSjrDgd3LCtjMzNaquxlPRLwj6T5gdZq13CPpU8A8SQCvA8cC04GTJS0HniRbbjMzs5LVXeJJLxXsDhzZ1hYRFwMXV+h+UKVrRMTA6kRnZmadqaulNknbA88AMyPi6bLjMTOz7qurGU9EPA58ouw4zMys5+oq8Vh1VOvT52ZmldTVUpuZmdU/Jx4zMyuUl9qM/7hkXNkhlGKbCdPKDsGsIXnGY2ZmhXLiMTOzQjnxmJlZoeoq8UhqkvRY2XGYmVnP1VXiqQZJfsHCzKxA9Zh4+km6IlUVvUfSAEmjJM1PFUhvlfRBAEmzJTWn7cGSVqbt8ZLukDQLmFneUMzMGk89Jp5hwKURMQJYDRwBXAucFRE7AkuB73fhOrsA4yLis9UK1MzM/lo9Jp4VEbEobbcCQ4FBEXF/arsG2LvSie3cGxH/XemAS1+bmVVPPSaet3Pb7wGD1tP3L6wdY/92x/6no5Nc+trMrHrqMfG09yrwiqS90v5XgLbZz0pgdNpuzJ/nm5nVmL7yRtfXgF9J2gR4Fjgutf8YuFHSScBdZQVnZmZr1VXiiYiVwMjc/o9zh3ev0P8JYMdc0zmpfQowpRoxmpnZ+vWFpTYzM6sjTjxmZlaoulpqs+pweQAzK5JnPGZmVignHjMzK5SX2owZ/3pw2SFskM+f8LuyQzCzbvCMx8zMCuXEY2ZmhXLiMTOzQvXpxCNpkKRTc/v7SLqzzJjMzBpdn048ZF+uPrWzTmZmVpyaSTySmiQ9IWmKpKckTZW0v6S5kp6WtJukD0m6LVUanS9px3TuRElXpYqjz0qakC57ITBU0iJJk1LbQEnT0r2mSlIpAzYza1C19jr1dsCRwPHAQuBoYE/gUOA7wHPAoxExVtJ+ZJVHR6VzhwP7ApsBT0q6DDgbGBkRoyBbagN2BkYAfwTmAnsAD1Z9ZGZmBtTQjCdZERFLI2INsAyYGRFBVs66iSwJ/RogImYBW0raPJ17V0S8HREvAX8CPtzBPR6OiOfTPRal667DFUjNzKqn1hJPvrromtz+GjqfnbWvTNpR/077uQKpmVn11Fri6cwc4Bh4f9nspYj483r6v0a29GZmZjWi1p7xdGYicJWkJcAbZJVHOxQRL6eXEx4D7sZVSM3MSlcziadCddHxHRwbW+Hcie3289c5ul332bljp/U0XjMz65l6W2ozM7M658RjZmaFqpmlNiuPywqYWZE84zEzs0I58ZiZWaGceMzMrFB+xmNc/uvP99q1vv6VGb12LTPrmzzjMTOzQjnxmJlZoZx4zMysUDWfeCR9p+wYzMys99R84iErAGdmZn1ETSWeVNa6VdKyVIztQmBAKl09NfU5VtLDqe1ySf1S++uSJqVz/z2Vym4rhX1o6jNe0u2p/WlJ3y9xuGZmDammEg9wfESMBpqBCcAk4M2IGBURx0j6FHAUsEcqZ/0eqT4PsCkwKyJGkNXh+SHwD8DhwPm5e+wGHAHsCBwpqbl9EK5AamZWPbX2O54Jkg5P21sDw9od/xwwGlgoCWAAWZlrgHeA6Wl7KfB2RLwrqa1sdpt7I+JlAEm3kJXTbsnfJCImA5MBmpubY8OHZWZmbWom8aSKovsDYyLiDUmzgf7tuwHXRMT/rXCJdyOiLUm8XzY7ItZIyo+zfSJxYjEzK1AtLbVtAbySks5wYPfU/q6kjdP2TGCcpL8FkPQhSdt28z7/kM4bQFZUbm4vxG5mZl1US4lnOvABScuBC4H5qX0ysETS1Ih4HDgHuCeVv74X2Kqb93kYuBlYAtwcES2d9Dczs15UM0ttEfE2cFCFQ7OBs3L9bgBuqHD+wNz2xI6OAc9HxNgNi9bMzHqqlmY8ZmbWALT2ebxV0tzcHC0tXo0zM+sOSa0R8Vc/VwHPeMzMrGBOPGZmVignHjMzK1TNvNVm5Tnu1gM7PHb14dM7PGZm1hOe8ZiZWaGceMzMrFBOPGZmVqiaTzySBkk6tew4zMysd9R84gEGAU48ZmZ9RD0knguBoani6CRJZ0paKGmJpPMAJDVJekLSFElPSZoqaX9Jc1Ol0d1Sv4mSfi1pXmo/sdSRmZk1oHpIPGcDv08VR+8lKw63GzAKGC1p79RvO+AnwPD052iyIm9nAN/JXW9HYD9gDHCupI+2v6ErkJqZVU89JJ68A9KfR4FHyBJMW5XSFRGxNCLWAMuAmakwXPsKpLdHxJsR8RJwH1kSW0dETI6I5ohoHjJkSPVGY2bWgOrtB6QC/iUiLl+nUWoiVRxN1uT217DuOF2B1MysRPUw43kN2CxtzwCOlzQQQNLH2qqRdsNhkvpL2hLYB1jYa5GamVmnan7GExEvp5cEHgPuBn4DzJME8DpwLPBeNy65hGyJbTDwg4j4Yy+HbGZm61HziQcgIo5u13RxhW4jc/3H57ZX5o8BSyLiq70Zn5mZdV09LLWZmVkfUhcznt4SERPLjqEW+QvUZlYkz3jMzKxQTjxmZlYoJx4zMytUQz3jscq+cOuk97fvOvzMEiMxs0bgGY+ZmRXKicfMzArlxGNmZoXq9cQj6XeSBnWjf1P6HE7hJL1exn3NzBpZr79cEBEH9/Y1zcys7+j2jCdVAJ2Qtn8qaVba3i9V/lwpaXCaySyXdIWkZZLukTQg9R0tabGkxcA3ctceIenhVG10iaRhueqiU9P1pknaJHed+yW1SpohaavUPlTS9NQ+R9Lw1P53qfroUkk/3OB/e2Zm1m09WWqbA+yVtpuBgZI2Tm0PtOs7DLg0IkYAq4EjUvvVwDcjYqd2/U8GLk7VRpuB51P73wO/jIhPAX8GTk33/DkwLiJGA1cBF6T+k9P1R5NVIP1lar8YuCwidgBe6GiArkBqZlY9PUk8rWQlpzcnK7Y2jyxJ7EWWlPJWRMSi3HlN6fnPoIhoS1K/zvWfB3xH0lnAthHxZmp/LiLmpu3ryEpa/z3ZV6fvlbQIOAf4eKrV8xngptR+ObBVOncP4PoK912HK5CamVVPt5/xRMS7klYA44GHyOrb7AtsByxv1z1fFfQ9YEAn1/6NpAXAF4DfSfo68CyVq4YKWBYRY/IHUkJcnWZNFW+zvhjMzKy6evpW2xyyJawH0vbJwKMR0el/1CNiNbBa0p6p6Zi2Y5I+ATwbEZcAtwM7pkPbSGpLMEcDDwJPAkPa2iVtLGlERPwZWCHpyNQuSW1LenOBL7W/r5mZFWdDEs9WwLyIeBF4i79eZluf44BL01KYcu3/BDyW2kcC16b2J4FvSFoOfJDsOc07wDjgovSSwiKyJTbIksoJqX0ZcFhq/1a6zlLgY92I18zMeom6MEkplaQm4M6IGNlZ32pobm6OlpaWMm5dGH+rzcx6m6TWiGiudMxfLjAzs0LV/NepI2Il2bKbVYlnOWZWJM94zMysUE48ZmZWKCceMzMrlBOPcci0qRwybWrZYZhZg3DiMTOzQjnxmJlZoZx4zMysUH0q8UiaKOmMsuMwM7OO9anEY2Zmta/uE4+k70p6StKDZDV6kHSipIWpyunNkjaRtJmkFamAHJI2z++bmVkx6jrxSBpNVuZgFHAwsGs6dEtE7JoqnC4HToiI14DZZLV+SOfdEhHvVriuK5CamVVJXScesqqnt0bEG6kOzx2pfaSkOan8wTHAiNR+JVlJBtI/r650UVcgNTOrnnpPPB2ZApwWETsA5wH9AVL57CZJ+wD9IuKxsgI0M2tU9Z54HgDGShogaTPgi6l9M+CF9PymfaXRa4Hf0MFsx8zMqquuE09EPALcACwG7gYWpkPfAxaQlbp+ot1pU8mqmF5fUJhmZpZT8/V4OhMRFwAXVDh0WQen7AlMi4jVVQvKzMw6VPeJpzsk/Rw4iOwNODMzK0FDJZ6I+GbZMdSiO8e1fwxmZlY9df2Mx8zM6o8Tj5mZFcqJx8zMCtVQz3ga0dhpMzvtc9u4zxUQiZlZxjMeMzMrlBOPmZkVyonHzMwKVbXEI6lJUq9/hFPS+ZL2r9C+j6Q70/ahks5O22Mlbd/bcZiZWc/U3csFEXFuF/rcwdoSCWOBO4HHqxiWmZl1UbWX2vpJukLSMkn3pK9Iz5bUDCBpsKSVaXu8pNsk3StppaTTJJ0u6VFJ8yV9KPWbImlc2j5Q0hOSHgH+se2m6Vq/kPQZ4FBgkqRFkoamvm39huX3zcys+qqdeIYBl0bECGA1cEQn/UeSJZBdyT78+UZE7AzMA76a7yipP3AFWSmE0cBH2l8sIh4im/mcGRGjIuL3wKuSRqUuFYvBuQKpmVn1VDvxrIiIRWm7FWjqpP99EfFaRKwCXgX+LbUvrXDu8HT9pyMigOu6GNOVwHGS+gFHkdXmWYcrkJqZVU+1E8/bue33yJ4p/SV33/7r6b8mt7+G3nsedTPZF6oPAVoj4uVeuq6ZmXVBGa9TryRbGgMYtwHXeYKsjPXQtP/lDvq9RlaRFICIeAuYQVavx1VIzcwKVkbi+TFwiqRHgcE9vUhKICcBd6UXBP7UQdffAmemlxTaktRUslnUPT29v5mZ9YyyxyONRdIZwBYR8b3O+jY3N0dLS0sBUVWHv9VmZmWQ1BoRzZWO1d3veDaUpFuBocB+ZcdiZtaIGi7xRMThZcdgZtbIGi7xNBovo5lZrfFHQs3MrFBOPGZmVigvtfVxE259rtM+lxy+dQGRmJllPOMxM7NCOfGYmVmhnHjMzKxQdZl4Ur2dj+b2V0rq8ed3zMysOHWZeIDxwEc769QVkvyChZlZgQpJPJLOlDQhbf9U0qy0vZ+kqZIOkDRP0iOSbpI0MB0/V9JCSY9JmqzMOKAZmJqqig5It/lmOn+ppOHp/E0lXSXp4fSR0MNS+3hJd6Q4Ov+YmZmZ9ZqiZjxzgL3SdjMwUNLGqW0JcA6wf0TsArQAp6e+v4iIXSNiJDAAOCQipqU+x6Sqom+mvi+l8y8Dzkht3wVmRcRuwL5kJbA3Tcd2AcZFxGfbB+sKpGZm1VNU4mkFRkvanKy42zyyBLQX8CawPTBX0iLga8C26bx9JS2QtJTso54j1nOPW3L3akrbBwBnp+vOJis8t006dm9E/HelC7kCqZlZ9RTyfCMi3pW0guzZzENks5x9ge2AFWRJYJ1CbpL6A78EmiPiOUkT+euKpXlt1UrbKp0CCDgiIp5sd+1PA/+zIWMyM7OeKfLlgjlkS2APpO2TgUeB+cAekraD95/LfJK1Seal9MwnX610naqi6zGD7NmP0rV37o2BmJlZzxWdeLYC5kXEi8BbwJyIWEU2E7pe0hKyZbjhEbEauAJ4jCyBLMxdawrwq3YvF1TyA2BjYImkZWnfzMxK1JAVSLuj3iuQ+lttZlaG9VUgrdff8ZiZWZ1y4jEzs0L5V/t9nJfRzKzWeMZjZmaFcuIxM7NCeamtBt19w0uF3u+go/xhbzMrjmc8ZmZWKCceMzMrlBOPmZkVyonHzMwK5cRjZmaFKjXxpC9R3yVpcaoyepSk0ZLul9QqaYakrVLfE1M10sWSbpa0SWo/Mp27WNIDqa2/pKtTNdJHJe2b2sdLukXSdElPS/pReaM3M2tMZc94DgT+GBE7pSqj04Gfk1UGHQ1cBVyQ+t6SqpHuBCwHTkjt5wKfT+2HprZvABEROwBfBq5J9X0ARgFHATsAR0nyT/vNzApU9u94lgI/kXQRcCfwCjASuDeV0OkHvJD6jpT0Q2AQMJCsVALAXGCKpBtZW4V0T7IERkQ8IekPwCfTsZkR8SqApMfJqp2u8wlnSScBJwFss802mJlZ7yk18UTEU5J2AQ4GfgjMApZFxJgK3acAYyNisaTxwD7pGieniqJfAFolje7ktm/ntvPVSvNxTQYmQ1YWoTtjMjOz9Sv7Gc9HgTci4jpgEvBpYIikMen4xpJGpO6bAS9I2hg4JneNoRGxICLOBVYBW5MVnTsmHf8ksA2wTvlrMzMrR9lLbTsAkyStAd4FTgH+AlwiaQuy+H4GLAO+BywgSy4LWFv6epKkYYCAmcBi4AngMklL0/XGR8TbafnOzMxK5AqknSijAqm/1WZm9c4VSM3MrGY48ZiZWaHKfsZjFXjpy8z6Ms94zMysUE48ZmZWKC+11ZiVP/uvwu/Z9O2PFH5PM2tcnvGYmVmhnHjMzKxQTjxmZlao0hKPpCZJj3Wj/xRJ49L2lZK2r9BnvKRf9GacZmbWu+ry5YKI+OeyYzAzs54pe6mtn6QrJC2TdI+kAZJGSZovaYmkWyV9sP1JkmZLak7bx0l6StLDwB65Pl+UtCBVIP13SR+WtFGqPDok9dlI0jNt+2ZmVn1lJ55hwKURMQJYDRwBXAucFRE7khWK+35HJ6ey2OeRJZw9gfzy24PA7hGxM/Bb4P9ExBrgOtaWVdgfWBwRq3pzUGZm1rGyE8+KiFiUtluBocCgiLg/tV0D7L2e8z8NzI6IVRHxDnBD7tjHgRmpNMKZQFtdn6uAr6bt44Gr219U0kmSWiS1rFrlnGRm1pvKTjztq4EO6sVr/xz4RUTsAHwd6A8QEc8BL0raD9gNuLv9iRExOSKaI6J5yBCvwpmZ9aayE097rwKvSNor7X8FuH89/RcAn5W0ZapMemTu2BbAf6btr7U770qyJbebIuK9DQ/bzMy6qtYSD2RJYpKkJcAo4PyOOkbEC8BEYB4wF1ieOzwRuElSK9C+stodwEAqLLOZmVl1lfY6dUSsBEbm9n+cO7x7hf7jc9v75LavpkICiYjbgds7uP1OZC8VPNHNsM3MbAPV5e94NoSks4FTWPtmm5mZFagWl9qqKiIujIhtI+LBsmMxM2tEDTfjqXUuUWBmfV3DzXjMzKxcTjxmZlYoL7VV0YsXzys7hC758LfGlB2CmTUQz3jMzKxQTjxmZlYoJx4zMyuUE4+ZmRWqsMQjaaWkwRXaH6r2PczMrHYUkngk9evoWER8pogYzMysNnSaeCSdKWlC2v6ppFlpez9JUyV9WdJSSY9Juih33uuSfiJpMTAm1z5A0t2STmzrl/65TyppPU3SE+naSscOTm2tki6RdGdq3zKVzF4m6UpAufvclvovk3RSajte0s9yfU6U9NMN+PdnZmbd1JUZzxygrT5OMzAw1b7ZC3gKuAjYj6yEwa6Sxqa+mwILImKn3HfRBgL/BlwfEVdUuNfOwLfJSlh/AthDUn/gcuCgiBgN5CuzfR94MJXOvhXYJnfs+NS/GZggaUvgRuCLKX6A48gqkq7DFUjNzKqnK4mnFRgtaXOyiqHzyP5jvhewmrWlp/8CTGVtqer3gJvbXet24OqIuLaDez0cEc9HxBpgEdAEDAeejYgVqc/1uf57kxV0IyLuAl7JHZuQZlvzga2BYRHxOjALOETScGDjiFjaPghXIDUzq55OE09EvAusAMYDD5HNgPYFtgNWrufUtypU95wLHNi2hFZB+1LYPfqygqR9gP2BMRGxE/AoqfQ1WfXR8WSzHReCMzMrWFdfLpgDnAE8kLZPJvuP+cNkpacHpxcIvsz6S1WfSzYrubQbMT4JfEJSU9o/KnfsAeBoAEkHAR9M7VsAr0TEG2lm835huYhYQDYDOpp1Z09mZlaA7iSerYB5EfEi8BYwJ5WePhu4D1gMtKbKn+vzLWCApB915cYR8SZwKjA9lbF+DXg1HT4P2FvSMuAfgf9I7dOBD0haDlxIttyWdyMwNyJewczMCtWlpayImAlsnNv/ZG77eirMHCJiYLv9ptzuce37RcRsYHau/bRc//siYnhaorsUaEl9XgYO6CDsg9YzpD0Bv81mZlaCevlywYmSFgHLyJbRLu/JRSQNkvQU8GZKpmZmVjBFRNkx1LTm5uZoaWkpOwwzs7oiqTUimisdq5cZj5mZ9RGe8XRC0irgD2XHUWWDgZfKDqIkHnvjadRxQ7Fj3zYiKv4Q0onHkNTS0ZS4r/PYG2/sjTpuqJ2xe6nNzMwK5cRjZmaFcuIxgMllB1Aij73xNOq4oUbG7mc8ZmZWKM94zMysUE48ZmZWKCeeBiLpQElPSnpG0tkVjv8vSTek4wtyXwSve10Y+96SHpH0F0njyoixGrow7tMlPS5piaSZkrYtI85q6MLYT07VkxdJelDS9mXEWQ2djT3X7whJIanYV6wjwn8a4A/QD/g9WWXXvyH7mvj27fqcCvwqbX8JuKHsuAscexOwI3AtMK7smAsc977AJmn7lAb7O988t30oML3suIsae+q3GVlpmflAc5ExesbTOHYDnomIZyPiHeC3wGHt+hwGXJO2pwGfW0/RvnrS6dgjYmVELAHWlBFglXRl3PdFxBtpdz7w8YJjrJaujP3Pud1Ngb7yplVX/rcO8APgIrIyN4Vy4mkcHwOey+0/n9oq9omslPmrwJaFRFddXRl7X9TdcZ8A3F3ViIrTpbFL+oak3wM/AiYUFFu1dTp2SbsAW0fEXUUG1saJx8yQdCzQDEwqO5YiRcSlETEUOAs4p+x4iiBpI+D/Af+7rBiceBrHf5KV/G7z8dRWsY+kD5DVPnq5kOiqqytj74u6NG5J+wPfBQ6NiLcLiq3auvt3/ltgbDUDKlBnY98MGAnMlrQS2B24o8gXDJx4GsdCYJikv5P0N2QvD9zRrs8dwNfS9jhgVqSnkHWuK2Pvizodt6SdyQorHhoRfyohxmrpytiH5Xa/ADxdYHzVtN6xR8SrETE4Ipoiqww9n+zvv7DCY048DSI9szkNmAEsB26MiGWSzpd0aOr2r8CWkp4BTgc6fA2znnRl7JJ2lfQ8cCRwuaRl5UXcO7r4dz4JGAjclF4r7hMJuYtjP03SslTd+HTW/p+uutbFsZfKn8wxM7NCecZjZmaFcuIxM7NCOfGYmVmhnHjMzKxQTjxmZlYoJx4zMyuUE4+ZmRXq/wMxHffPgQ1toAAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Year feature의 회귀 계수값이 독보적으로 큰 값을 가지고 있다. Year는 2011,2012년 두개의 값으로만 이루어졌는데 상식적으로 Year가 자전거 대여 횟수에 크게 영향을 준다(회귀 계수가 큼)는 것은 납득하기 어렵다. 그럼 왜 Year feature의 회귀계수가 클까?</li>
<li>Year feature는 datetime이라는 카테고리형 feature지만 숫자형 값으로 돼 있다. 더군다나 아주 큰 2011,2012로 이루어져있다. 사이킷런은 카테고리만을 위한 데이터 타입이 없으며 모두 숫자로 변환해야 한다. 하지만 이처럼 카테고리 값을 선형 회귀에 사용할 경우 회귀 계수를 연산할 때 이 숫자형 값에 크게 영향을 받는 경우가 발생할 수 있다. 따라서 선형 회귀에서는 이러한 feature 인코딩에 원-핫 인코딩을 적용해 변환해야한다. </li>
<li>오랜만에 판다스의 get_dummies()를 이용해 year칼럼과 더불어 datetime칼럼 그리고 holiday 등등 모두 원-핫 인코딩 후 다시 예측 성능을 확인해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_features_ohe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;holiday&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;workingday&#39;</span><span class="p">,</span><span class="s1">&#39;season&#39;</span><span class="p">,</span><span class="s1">&#39;weather&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_features_ohe</span><span class="p">,</span> <span class="n">y_target_log</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 모델과 학습/테스트 데이터 셋을 입력하면 성능 평가 수치를 반환</span>
<span class="k">def</span> <span class="nf">get_model_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">is_expm1</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_expm1</span> <span class="p">:</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;###&#39;</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;###&#39;</span><span class="p">)</span>
    <span class="n">evaluate_regr</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="c1"># end of function get_model_predict    </span>

<span class="c1"># model 별로 평가 수행</span>
<span class="n">lr_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">ridge_reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">lasso_reg</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">lr_reg</span><span class="p">,</span> <span class="n">ridge_reg</span><span class="p">,</span> <span class="n">lasso_reg</span><span class="p">]:</span>
    <span class="n">get_model_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="n">is_expm1</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>### LinearRegression ###
RMSLE: 0.589, RMSE: 97.482, MAE: 63.105
### Ridge ###
RMSLE: 0.589, RMSE: 98.407, MAE: 63.648
### Lasso ###
RMSLE: 0.634, RMSE: 113.031, MAE: 72.658
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>선형 회귀에 예측 성능이 많이 향상 됐다. 원-핫 인코딩된 데이터에서 회귀 계수가 높은 feature를 다시 시각화해보자. 원-핫 인코딩으로 feature가 늘어났으므로 상위 10개만 추출해보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lr_reg</span><span class="o">.</span><span class="n">coef_</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_features_ohe</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">coef_sort</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coef_sort</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">coef_sort</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번에는 회귀 트리를 이용해 회귀 예측을 수행해보자. 앞에서 적용한 Target 값의 로그 변환된 값과 원-핫 인코딩된 feature 데이터 세트를 그래도 이용해 여러 모델에 대한 성능을 평가해보자.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMRegressor</span>


<span class="c1"># 랜덤 포레스트, GBM, XGBoost, LightGBM model 별로 평가 수행</span>
<span class="n">rf_reg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">gbm_reg</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">xgb_reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">lgbm_reg</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rf_reg</span><span class="p">,</span> <span class="n">gbm_reg</span><span class="p">,</span> <span class="n">xgb_reg</span><span class="p">,</span> <span class="n">lgbm_reg</span><span class="p">]:</span>
    <span class="n">get_model_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="n">is_expm1</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>### RandomForestRegressor ###
RMSLE: 0.354, RMSE: 50.738, MAE: 31.493
### GradientBoostingRegressor ###
RMSLE: 0.340, RMSE: 55.822, MAE: 34.355
### XGBRegressor ###
RMSLE: 0.339, RMSE: 50.950, MAE: 30.891
### LGBMRegressor ###
RMSLE: 0.316, RMSE: 46.473, MAE: 28.777
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞의 선형 회귀 모델보다 회귀 예측 성능이 개선됐다. 하지만 이게 선형회귀 보다 회귀 트리가 더 낫다는 건 아니다. 데이터 세트의 유형에 따라 결과는 얼마든지 달라질 수 있다. </li>
</ul>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/INTROml/2022/01/12/intro.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/INTROml/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/INTROml/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/INTROml/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/rhkrehtjd" target="_blank" title="rhkrehtjd"><svg class="svg-icon grey"><use xlink:href="/INTROml/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
